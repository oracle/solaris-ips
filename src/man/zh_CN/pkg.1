<?xml version="1.0" encoding="utf-8"?>
<!--Arbortext, Inc., 1988-2008, v.4002-->
<!DOCTYPE refentry PUBLIC "-//Sun Microsystems//DTD SolBook-XML 3.7//EN" "xsolbook.dtd" [
<!ENTITY % ent SYSTEM "entities.ent">
%ent;
]>

<refentry lang="zh" id="pkg-1">
<refmeta><refentrytitle>pkg</refentrytitle><manvolnum>1</manvolnum> <refmiscinfo class="date">2016 年 5 月 20 日</refmiscinfo> <refmiscinfo class="sectdesc">&man1;</refmiscinfo> <refmiscinfo class="software">&release;</refmiscinfo> <refmiscinfo class="arch">generic</refmiscinfo> <refmiscinfo class="copyright">Copyright (c) 2007, 2017, Oracle and/or its affiliates. All rights reserved.</refmiscinfo>
</refmeta>
<refnamediv>
<refname>pkg</refname><refpurpose>映像包管理系统的检索客户端</refpurpose>
</refnamediv>
<refsynopsisdiv><title></title>
<synopsis>/usr/bin/pkg [<replaceable>options</replaceable>] command [<replaceable>
cmd_options</replaceable>] [<replaceable>operands</replaceable>]</synopsis>
<synopsis>/usr/bin/pkg refresh [-q] [--full] [<replaceable>publisher</replaceable> ...]
</synopsis>
<synopsis>/usr/bin/pkg install [-nvq] [-C <replaceable>n</replaceable>] [-g <replaceable>path_or_uri</replaceable>]...
    [-r [[-z <replaceable>zonename</replaceable>]... | [-Z <replaceable>zonename</replaceable>]... ]]
    [--accept] [--licenses] [--no-index] [--no-refresh]
    [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    [--reject <replaceable>pkg_fmri_pattern</replaceable>]...
    [--sync-actuators | --sync-actuators-timeout <replaceable>timeout</replaceable>]
    <replaceable>pkg_fmri_pattern</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkg exact-install [-nvq] [-C <replaceable>n</replaceable>] [-g <replaceable>path_or_uri</replaceable>]...
    [--accept] [--licenses] [--no-index] [--no-refresh]
    [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    [--reject <replaceable>pkg_fmri_pattern</replaceable>]...  <replaceable>pkg_fmri_pattern</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkg uninstall [-nvq] [-C <replaceable>n</replaceable>]
    [-r [[-z <replaceable>zonename</replaceable>]... | [-Z <replaceable>zonename</replaceable>]... ]]
    [--ignore-missing] [--no-index] [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    [--sync-actuators | --sync-actuators-timeout <replaceable>timeout</replaceable>]
    <replaceable>pkg_fmri_pattern</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkg update [-fnvq] [-C <replaceable>n</replaceable>] [-g <replaceable>path_or_uri</replaceable>]...
    [-r [[-z <replaceable>zonename</replaceable>]... | [-Z <replaceable>zonename</replaceable>]... ]]
    [--accept] [--ignore-missing] [--licenses]
    [--no-index] [--no-refresh] [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    [--reject <replaceable>pkg_fmri_pattern</replaceable>]...
    [--sync-actuators | --sync-actuators-timeout <replaceable>timeout</replaceable>]
    [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg list [-Hafnqsuv] [-g <replaceable>path_or_uri</replaceable>]...
    [--no-refresh] [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg info [-lqr] [-g <replaceable>path_or_uri</replaceable>]... [--license]
    [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg contents [-Hmr] [-a <replaceable>attribute</replaceable>=<replaceable>pattern</replaceable>]...
    [-g <replaceable>path_or_uri</replaceable>]... [-o <replaceable>attribute</replaceable>[,<replaceable>attribute</replaceable>]...]...
    [-s <replaceable>sort_key</replaceable>] [-t <replaceable>action_name</replaceable>[,<replaceable>action_name</replaceable>]...]...
    [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg search [-HIaflpr]
    [-o <replaceable>attribute</replaceable>[,<replaceable>attribute</replaceable>]...]... [-s <replaceable>repo_uri</replaceable>] <replaceable>query</replaceable></synopsis>
<synopsis>/usr/bin/pkg verify [-Hqv] [-p <replaceable>path</replaceable>]... [--parsable <replaceable>version</replaceable>]
    [--unpackaged] [--unpackaged-only] [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg fix [-Hnvq] [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    [--accept] [--licenses] [--parsable <replaceable>version</replaceable>] [--unpackaged] [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg revert [-nv] [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    (--tagged <replaceable>tag-name</replaceable> ... | <replaceable>path-to-file</replaceable> ...)</synopsis>
<synopsis>/usr/bin/pkg mediator [-aH] [-F <replaceable>format</replaceable>] [<replaceable>mediator</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg set-mediator [-nv] [-I <replaceable>implementation</replaceable>]
    [-V <replaceable>version</replaceable>] [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    <replaceable>mediator</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkg unset-mediator [-nvIV] [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    <replaceable>mediator</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkg variant [-Haiv] [-F <replaceable>format</replaceable>] [<replaceable>variant_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg change-variant [-nvq] [-C <replaceable>n</replaceable>] [-g <replaceable>path_or_uri</replaceable>]...
    [-r [[-z <replaceable>zonename</replaceable>]... | [-Z <replaceable>zonename</replaceable>]... ]]
    [--accept] [--licenses] [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    [--sync-actuators | --sync-actuators-timeout <replaceable>timeout</replaceable>]
    <replaceable>variant_name</replaceable>=<replaceable>value</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkg facet [-Haim] [-F <replaceable>format</replaceable>] [<replaceable>facet_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg change-facet [-nvq] [-C <replaceable>n</replaceable>] [-g <replaceable>path_or_uri</replaceable>]...
    [-r [[-z <replaceable>zonename</replaceable>]... | [-Z <replaceable>zonename</replaceable>]... ]]
    [--accept] [--licenses] [--no-be-activate]
    [--no-backup-be | --require-backup-be]
    [--backup-be-name <replaceable>name</replaceable>]
    [--deny-new-be | --require-new-be] [--be-name <replaceable>name</replaceable>]
    [--sync-actuators | --sync-actuators-timeout <replaceable>timeout</replaceable>]
    <replaceable>facet_name</replaceable>=(True|False|None) ...</synopsis>
<synopsis>/usr/bin/pkg avoid [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg unavoid [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg freeze [-n] [-c <replaceable>reason</replaceable>] [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg unfreeze [-n] [<replaceable>pkg_name_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg property [-H] [<replaceable>propname</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg set-property <replaceable>propname</replaceable> <replaceable>propvalue</replaceable></synopsis>
<synopsis>/usr/bin/pkg add-property-value <replaceable>propname</replaceable> <replaceable>propvalue</replaceable></synopsis>
<synopsis>/usr/bin/pkg remove-property-value <replaceable>propname</replaceable> <replaceable>propvalue</replaceable></synopsis>
<synopsis>/usr/bin/pkg unset-property <replaceable>propname</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkg publisher [-HPn] [-F <replaceable>format</replaceable>] [<replaceable>publisher</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkg set-publisher [-Ped] [-c <replaceable>ssl_cert</replaceable>] [-k <replaceable>ssl_key</replaceable>]
    [-g <replaceable>origin_to_add</replaceable> | --add-origin <replaceable>origin_to_add</replaceable>]...
    [-G <replaceable>origin_to_remove</replaceable> | --remove-origin <replaceable>origin_to_remove</replaceable>]...
    [-m <replaceable>mirror_to_add</replaceable> | --add-mirror <replaceable>mirror_to_add</replaceable>]...
    [-M <replaceable>mirror_to_remove</replaceable> | --remove-mirror <replaceable>mirror_to_remove</replaceable>]...
    [--disable] [--enable] [--no-refresh] [--reset-uuid]
    [--non-sticky] [--sticky] [--search-after <replaceable>publisher</replaceable>]
    [--search-before <replaceable>publisher</replaceable>] [--search-first]
    [--approve-ca-cert <replaceable>path_to_CA</replaceable>]
    [--revoke-ca-cert <replaceable>hash_of_CA_to_remove</replaceable>]
    [--unset-ca-cert <replaceable>hash_of_CA_to_remove</replaceable>]
    [--set-property <replaceable>name_of_property</replaceable>=<replaceable>value</replaceable>]
    [--add-property-value <replaceable>name_of_property</replaceable>=<replaceable>value_to_add</replaceable>]
    [--remove-property-value <replaceable>name_of_property</replaceable>=<replaceable>value_to_remove</replaceable>]
    [--unset-property <replaceable>name_of_property_to_delete</replaceable>]
    [--proxy <replaceable>proxy_to_use</replaceable>] <replaceable>publisher</replaceable></synopsis>
<synopsis>/usr/bin/pkg set-publisher -p <replaceable>repo_uri</replaceable> [-Ped]
    [-c <replaceable>ssl_cert</replaceable>] [-k <replaceable>ssl_key</replaceable>] [--non-sticky] [--sticky]
    [--search-after <replaceable>publisher</replaceable>] [--search-before <replaceable>publisher</replaceable>]
    [--search-first] [--approve-ca-cert <replaceable>path_to_CA</replaceable>]
    [--revoke-ca-cert <replaceable>hash_of_CA_to_remove</replaceable>]
    [--unset-ca-cert <replaceable>hash_of_CA_to_remove</replaceable>]
    [--set-property <replaceable>name_of_property</replaceable>=<replaceable>value</replaceable>]
    [--add-property-value <replaceable>name_of_property</replaceable>=<replaceable>value_to_add</replaceable>]
    [--remove-property-value <replaceable>name_of_property</replaceable>=<replaceable>value_to_remove</replaceable>]
    [--unset-property <replaceable>name_of_property_to_delete</replaceable>]
    [--proxy <replaceable>proxy_to_use</replaceable>] [<replaceable>publisher</replaceable>]</synopsis>
<synopsis>/usr/bin/pkg unset-publisher <replaceable>publisher</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkg history [-HNl]
    [-n <replaceable>number</replaceable>] [-o <replaceable>column</replaceable>[,<replaceable>column</replaceable>]...]...
    [-t <replaceable>time</replaceable> | <replaceable>time</replaceable>-<replaceable>time</replaceable>[,<replaceable>time</replaceable> | <replaceable>time</replaceable>-<replaceable>time</replaceable>]...]...</synopsis>
<synopsis>/usr/bin/pkg purge-history</synopsis>
<synopsis>/usr/bin/pkg rebuild-index</synopsis>
<synopsis>/usr/bin/pkg update-format</synopsis>
<synopsis>/usr/bin/pkg version</synopsis>
<synopsis>/usr/bin/pkg help [-v]</synopsis>
<synopsis>/usr/bin/pkg image-create [-FPUfz] [--force]
    [--full | --partial | --user] [--zone]
    [-c <replaceable>ssl_cert</replaceable>] [-k <replaceable>ssl_key</replaceable>]
    [-g <replaceable>path_or_uri</replaceable> | --origin <replaceable>path_or_uri</replaceable>]...
    [-m <replaceable>uri</replaceable> | --mirror <replaceable>uri</replaceable>]...
    [--facet <replaceable>facet_name</replaceable>=(True|False)]... [--no-refresh]
    [--set-property <replaceable>name_of_property</replaceable>=<replaceable>value</replaceable>]
    [--variant <replaceable>variant_name</replaceable>=<replaceable>value</replaceable>]...
    [(-p | --publisher) [<replaceable>name</replaceable>=]<replaceable>repo_uri</replaceable>] <replaceable>dir</replaceable></synopsis>
<synopsis>/usr/bin/pkg -R <replaceable>dir</replaceable> dehydrate [-nvq] [-p <replaceable>publisher</replaceable>]...</synopsis>
<synopsis>/usr/bin/pkg -R <replaceable>dir</replaceable> rehydrate [-nvq] [-p <replaceable>publisher</replaceable>]...</synopsis>
</refsynopsisdiv>
<refsect1 id="pkg-1-desc" role="description"><title></title>
<para><command>pkg</command> 是映像包管理系统的检索客户端。在有效配置下，可以调用 <command>pkg</command> 来为要安装的软件包创建位置（称为“映像”），然后将软件包安装到这些映像中。软件包由发布者发布。发布者可使其软件包在一个或多个系统信息库上可用，或者在软件包归档中可用。<command>pkg</command> 从发布者的系统信息库或软件包归档中检索软件包，然后将软件包安装到映像中。</para>
<para>只能将软件包安装到属于引导环境的文件系统中。例如，在缺省的 Oracle Solaris 11 安装上，软件包操作仅支持 <filename>rpool/ROOT/<replaceable>BEname</replaceable>/</filename> 下的数据集。</para>
<para>发布者名称将个人、个人组或组织标识为一个或多个软件包的源。为避免发布者名称冲突并有帮于标识发布者，最佳做法是使用代表发布软件包实体的域名作为发布者名称。</para>
<para>系统信息库是客户端可在其中发布和检索软件包内容（该软件包包含的文件，例如程序和文档）和元数据（有关该软件包的信息，例如其名称和说明）的位置。例如，有一个名为 <literal>example.org</literal> 的发布者，其系统信息库位于 URI <literal>http://example.org/repository</literal>。</para>
<para><command>pkg</command> 还可以卸载软件包、刷新发布者元数据（例如可用软件包的列表）、验证映像中的软件包安装，以及查询映像中的各个标记。也可以对 <literal>pkg</literal>(7) 系统信息库执行这些查询。</para>
<para>映像有三种类型：完整映像：能够提供完整的系统；部分映像：与完整映像（父映像）链接，但本身无法提供完整的系统；用户映像。</para>
</refsect1>
<refsect1 role="options"><title></title>
<para>支持以下选项：</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>?</option></term><term><option>-help</option></term>
<listitem><para>显示用法消息。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>R</option> <replaceable>dir</replaceable></term>
<listitem><para>对根目录为 <replaceable>dir</replaceable> 的映像进行操作。如果未根据环境指定或确定目录，则缺省值为 /。有关更多信息，请参见“环境变量”部分。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-network-cache</option></term>
<listitem><para>请求操作期间使用的所有网络服务器（代理）忽略缓存的数据使用此选项解决可能由软件包客户端和基于网络的软件包系统信息库之间的缓存代理所导致的问题。</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 role="subcommands"><title></title>
<para>支持以下子命令：</para>
<variablelist termlength="wholeline">
<varlistentry><term><command>pkg refresh</command> [<option>q</option>] [<option> -full</option>] [<replaceable>publisher</replaceable> ...]</term>
<listitem><para>对于所有发布者，更新客户机可用软件包列表和发布者元数据。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>publisher</replaceable></term>
<listitem><para>仅对指定的发布者，更新客户机可用软件包列表和发布者元数据。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>q</option></term>
<listitem><para>在执行请求的操作期间隐藏进度消息。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-full</option></term>
<listitem><para>强制完全检索所有发布者元数据（而不是尝试增量更新），并请求操作期间使用的所有代理忽略缓存的数据。此选项用于进行故障排除，正常情况下不应使用。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg install</command> [<option>nvq</option>] [<option>C</option> <replaceable>n</replaceable>] [<option>g</option> <replaceable>path_or_uri</replaceable>]... [<option>r</option> [[<option>z</option> <replaceable>zonename</replaceable>]... | [<option>Z</option> <replaceable>zonename</replaceable>]... ]] [<option>-accept</option>] [<option>-licenses</option>] [<option>-no-index</option>] [<option>-no-refresh</option>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be</option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name</option> <replaceable>name</replaceable>] [<option>-reject</option> <replaceable>pkg_fmri_pattern</replaceable>]... [<option>-sync-actuators</option> | <option>-sync-actuators-timeout</option> <replaceable>timeout</replaceable>] <replaceable>pkg_fmri_pattern</replaceable> ...</term>
<listitem><para>安装指定软件包并将其更新到最新版本，该版本与映像中安装的软件包所允许的 <replaceable>pkg_fmri_pattern</replaceable> 匹配。要显式请求安装软件包的最新版本，请在 <replaceable>pkg_fmri_pattern</replaceable> 的版本部分使用 <literal>latest</literal>。例如，指定 <literal>vim@latest</literal>。<replaceable>pkg_fmri_pattern</replaceable> 模式可以包含 <literal>?</literal> 和 <literal>*</literal> 字符作为 <literal>glob</literal>(3C) 式通配符，以匹配一个或多个软件包。</para>
<para>可以指定比已安装版本更高或更低的版本，以便对特定软件包执行就地降级或升级。不支持跨越软件包重命名边界或过时边界更新特定的软件包。</para>
<para>作为将要降级的软件包的一部分、自原始版本安装以来更改了的任何保留配置文件，将使用扩展名 <literal>.update</literal> 进行重命名。有关软件包系统如何确定要保留的文件，以及在软件包升级期间如何保留这些文件的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“文件操作”。</para>
<para>软件包基于发布者搜索顺序和粘性进行选择。有关搜索顺序和粘性的信息，请参见 <command>pkg publisher</command> 和 <command>pkg set-publisher</command> 命令。如果 <replaceable>pkg_fmri_pattern</replaceable> 未指定发布者，则会将第一个提供匹配软件包的发布者用作安装源。如果该发布者未提供可以安装在此映像中的软件包版本，则安装操作将失败。使用 <command>pkg list -a</command> 命令可查看哪些发布者提供可以安装在此映像中的软件包版本。</para>
<para>指定了多个 <replaceable>pkg_fmri_pattern</replaceable> 时，如果指定的软件包中有任何一个无法在此映像中安装，则指定的所有软件包都不会安装。</para>
<para>安装过程中，某些配置文件可能被重命名或替换。有关软件包系统如何确定要保留的文件以及在软件包操作期间如何保留这些文件的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“文件操作”。</para>
<para>如果某个软件包在避免列表中，则安装该软件包会将它从该列表中删除。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>C</option> <replaceable>n</replaceable></term>
<listitem><para>指定要并行更新的子映像数。在递归检查子映像（通常为安装的 <literal>solaris</literal> 标记非全局区域）时，最多可以并行更新 <replaceable>n</replaceable> 个子映像。并行更新的缺省子映像数为 1。如果 <replaceable>n</replaceable> 为 0 或负数，则并行更新所有子映像。另请参见“环境变量”部分中的 <envar>PKG_CONCURRENCY</envar>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>g</option> <replaceable>path_or_uri</replaceable></term>
<listitem><para>暂时将指定的软件包系统信息库或归档文件添加到从中检索软件包数据的映像的源列表内。需要客户机 SSL 证书的系统信息库不能与此选项一起使用。可以多次指定此选项。</para>
<para>确定要使用的软件包版本时，优先选择映像中配置的发布者，而非指定 <replaceable>path_or_uri</replaceable> 源中找到的发布者。如果映像中配置的发布者和 <replaceable>path_or_uri</replaceable> 源都提供要安装的软件包版本，则客户机将从 <replaceable>path_or_uri</replaceable> 源中检索该软件包的内容。安装或更新后，未在映像中配置的发布者提供的所有软件包都将添加到映像配置中，但添加的这些软件包没有源。使用 <command>pkg publisher</command> 命令可查看在映像中配置的发布者。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>n</option></term>
<listitem><para>试运行操作而不进行软件包更改。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>q</option></term>
<listitem><para>在执行请求的操作期间隐藏进度消息。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>r</option></term>
<listitem><para>在全局区域以及所有安装的 <literal>solaris</literal> 标记非全局区域中运行此操作。对非全局区域的效果与登录每个非全局区域并直接运行该命令类似。如果不指定此选项，则在全局区域中运行 <literal>pkg</literal> 命令时，仅在使非全局区域与全局区域保持兼容所需的程度上对非全局区域进行修改。如果指定此选项，则除了受 <option>z</option> 和 <option>Z</option> 选项限制外，<literal>pkg</literal> 操作将应用于所有安装的非全局区域。对于 <option>z</option> 和 <option>Z</option> 选项排除的区域，如果需要进行更新以保持其与全局区域同步，则仍可以对其进行修改。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>z</option> <replaceable>zonename</replaceable></term>
<listitem><para>仅在指定的非全局区域中运行此操作。可以多次指定 <option>z</option> 选项。<option>z</option> 选项只能与 <option>r</option> 选项一起使用。<option>z</option> 选项不能与 <option>Z</option> 选项一起使用。</para></listitem>
</varlistentry>
<varlistentry><term><option>Z</option> <replaceable>zonename</replaceable></term>
<listitem><para>在除指定区域外的所有非全局区域中运行此操作。可以多次指定 <option>Z</option> 选项。<option>Z</option> 选项只能与 <option>r</option> 选项一起使用。<option>Z</option> 选项不能与 <option>z</option> 选项一起使用。</para></listitem>
</varlistentry>
<varlistentry><term><option>v</option></term>
<listitem><para>在执行请求的操作期间发出详细进度消息，并显示详细的规划信息（例如更改侧面、中介和变量）。可以多次指定此选项，以增加显示的规划信息量。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-accept</option></term>
<listitem><para>表示同意并接受所更新或安装的软件包的许可证条款。如果存在任何需要您接受的软件包许可证，而您未提供此选项，则安装操作将失败。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-licenses</option></term>
<listitem><para>显示在此操作过程中所安装或更新的软件包的所有许可证。对于更新的软件包，仅当许可证已更改时才显示许可证。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-index</option></term>
<listitem><para>不在操作成功完成后更新搜索索引。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-refresh</option></term>
<listitem><para>不尝试联系映像发布者的系统信息库来检索最新的可用软件包列表和其他元数据。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-be-activate</option></term>
<listitem><para>如果创建了一个引导环境，不将其设置为下次引导时的活动引导环境。有关更多信息，请参见 <command>beadm</command>(8) 手册页。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-backup-be</option></term>
<listitem><para>不创建备份引导环境。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-require-backup-be</option></term>
<listitem><para>如果不创建新的引导环境，则始终创建一个备份引导环境。如果不使用该选项，则根据映像策略创建备份引导环境。有关何时自动创建备份引导环境的说明，请参见下文“映像属性”中的 <literal>be-policy</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-backup-be-name</option> <replaceable>name</replaceable></term>
<listitem><para>使用给定参数命名创建的备份引导环境。使用 <option>-backup-be-name</option> 表示 <option>-require-backup-be</option>。另请参见 <command>beadm</command>(8) 手册页。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-deny-new-be</option></term>
<listitem><para>不创建新的引导环境。如果需要新的引导环境，则不执行此操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-require-new-be</option></term>
<listitem><para>始终创建新的引导环境。如果不使用该选项，则根据映像策略创建引导环境。有关何时自动创建引导环境的说明，请参见下文“映像属性”中的 <literal>be-policy</literal>。该选项不能与 <option>require-backup-be</option> 一起使用。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-be-name</option> <replaceable>name</replaceable></term>
<listitem><para>将新创建的引导环境重命名为给定的参数。使用 <option>-be-name</option> 表示 <option>-require-new-be</option>。另请参见 <command>beadm</command>(8) 手册页。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-reject</option> <replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>阻止安装名称与给定模式匹配的软件包。如果已安装匹配的软件包，则在此操作过程会将其删除。作为组依赖性目标的被拒绝软件包将放置在避免列表中。可以多次指定此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-sync-actuators</option></term>
<listitem><para>同步运行 SMF 执行器。除非所有 SMF 执行器在调用了 <command>pkg</command> 的区域（全局区域或非全局区域）中已完成，否则 <command>pkg</command>(1) 命令不会返回。</para></listitem>
</varlistentry>
<varlistentry><term><option>-sync-actuators-timeout</option> <replaceable>timeout</replaceable></term>
<listitem><para>同步运行 SMF 执行器。如果执行器未在给定的 <replaceable>timeout</replaceable>（以秒为单位）内完成，<command>pkg</command>(1) 将继续运行并以返回代码 8 退出。</para></listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg exact-install</command> [<option>nvq</option>] [<option>C</option> <replaceable>n</replaceable>] [<option>g</option> <replaceable>path_or_uri</replaceable>]... [<option>-accept</option>] [<option>-licenses</option>] [<option>-no-index</option>] [<option>-no-refresh</option>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be</option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name</option> <replaceable>name</replaceable>] [<option>-reject</option> <replaceable>pkg_fmri_pattern</replaceable>]... <replaceable>pkg_fmri_pattern</replaceable> ...</term>
<listitem><para>像在裸系统中安装一样安装或更新指定的软件包。将删除未在命令行中指定且不是指定软件包的依赖项的所有之前安装的软件包。此命令将忽略不安装避免列表上的软件包以及不更新冻结列表上的软件包的限制。在其他方面，此 <command>exact-install</command> 子命令的行为与 <command>install</command> 子命令的行为相同。要显式请求安装软件包的最新版本，请在 <replaceable>pkg_fmri_pattern</replaceable> 的版本部分使用 <literal>latest</literal>。例如，指定 <literal>vim@latest</literal>。</para>
<para>软件包基于发布者搜索顺序和粘性进行选择。有关搜索顺序和粘性的信息，请参见 <command>pkg publisher</command> 和 <command>pkg set-publisher</command> 命令。如果 <replaceable>pkg_fmri_pattern</replaceable> 未指定发布者，则会将第一个提供匹配软件包的发布者用作安装源。如果该发布者未提供可以安装在此映像中的软件包版本，则安装操作将失败。使用 <command>pkg list -a</command> 命令可查看哪些发布者提供可以安装在此映像中的软件包版本。</para>
<para>指定了多个 <replaceable>pkg_fmri_pattern</replaceable> 时，如果指定的软件包中有任何一个无法在此映像中安装，则指定的所有软件包都不会安装。</para>
<para>安装过程中，某些配置文件可能被重命名或替换。有关软件包系统如何确定要保留的文件以及在软件包操作期间如何保留这些文件的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“文件操作”。</para>
<para>如果某个软件包在避免列表中，则安装该软件包会将它从该列表中删除。</para>
<para>有关选项的说明，请参见上述 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg uninstall</command> [<option>nvq</option>] [<option>C</option> <replaceable>n</replaceable>] [<option>r</option> [[<option>z</option> <replaceable>zonename</replaceable>]... | [<option>Z</option> <replaceable>zonename</replaceable>]... ]] [<option>-ignore-missing</option>] [<option>-no-index</option>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be</option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name</option> <replaceable>name</replaceable>] [<option>-sync-actuators</option> | <option>-sync-actuators-timeout</option> <replaceable>timeout</replaceable>] <replaceable>pkg_fmri_pattern</replaceable> ...</term>
<listitem><para>删除与 <replaceable>pkg_fmri_pattern</replaceable> 匹配的已安装软件包。</para>
<para>如果某个软件包是组依赖性的主体，则卸载该软件包会将它放置在避免列表中。请参见下文的 <command>avoid</command> 子命令。</para>
<para>在命令输出中，请注意任何指出已创建新引导环境的消息。如果已创建并激活新引导环境，缺省情况下，下次重新引导时会引导该环境。有关管理引导环境的信息，请参见 <command>beadm</command>(8) 手册页。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>-ignore-missing</option></term>
<listitem><para>忽略未安装的软件包。使用此选项可防止 <command>pkg uninstall</command> 在尝试卸载当前未安装的软件包时失败。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg update</command> [<option>fnvq</option>] [<option>C</option> <replaceable>n</replaceable>] [<option>g</option> <replaceable>path_or_uri</replaceable>]... [<option>r</option> [[<option>z</option> <replaceable>zonename</replaceable>]... | [<option>Z</option> <replaceable>zonename</replaceable>]... ]] [<option>-accept</option>] [<option>-ignore-missing</option>] [<option>-licenses</option>] [<option>-no-index</option>] [<option>-no-refresh</option>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be</option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name</option> <replaceable>name</replaceable>] [<option>-reject</option> <replaceable>pkg_fmri_pattern</replaceable>]... [<option>-sync-actuators</option> | <option>-sync-actuators-timeout</option> <replaceable>timeout</replaceable>] [<replaceable>pkg_fmri_pattern</replaceable> ...]</term>
<listitem><para>将当前映像中安装的所有软件包更新到最新版本，该版本需符合已安装的软件包和发布者配置对系统施加的约束。</para>
<para>在命令输出中，请注意任何指出已创建新引导环境的消息。如果已创建并激活新引导环境，在未指定 <option>-no-be-activate</option> 选项时，缺省情况下，下次重新引导时会引导该环境。有关管理引导环境的信息，请参见 <command>beadm</command>(8) 手册页。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>仅更新当前映像中安装的指定软件包。如果在所提供的 <replaceable>pkg_fmri_pattern</replaceable> 模式中有一个为星号 (*)，则会更新当前映像中安装的所有软件包，就像未提供 <replaceable>pkg_fmri_pattern</replaceable> 一样。</para>
<para>要显式请求安装软件包的最新版本，请在 <replaceable>pkg_fmri_pattern</replaceable> 的版本部分使用 <literal>latest</literal>。例如，指定 <literal>vim@latest</literal>。</para>
<para>可以指定比已安装版本更高或更低的版本，以便对特定软件包执行就地降级或升级。不支持跨越软件包重命名边界或过时边界更新特定的软件包。</para>
<para>作为将要降级的软件包的一部分、自原始版本安装以来更改了的任何保留配置文件，将使用扩展名 <literal>.update</literal> 进行重命名。有关软件包系统如何确定要保留的文件，以及在软件包升级期间如何保留这些文件的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“文件操作”。</para>
<para>指定了多个 <replaceable>pkg_fmri_pattern</replaceable> 时，如果指定的软件包中有任何一个无法在此映像中更新，则指定的所有软件包都不会更新。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>f</option></term>
<listitem><para>不在更新已安装的所有软件包时执行客户机最新状态检查。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-ignore-missing</option></term>
<listitem><para>忽略未安装的软件包。使用此选项可防止 <command>pkg update</command> 在尝试更新当前未安装的软件包时失败。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg list</command> [<option>Hafnqsuv</option>] [<option>g</option> <replaceable>path_or_uri</replaceable>]... [<option>-no-refresh</option>] [<replaceable>pkg_fmri_pattern</replaceable> ...]</term>
<listitem><para>显示当前映像中安装的所有软件包的列表，包括版本和安装状态等信息。缺省情况下，会排除不同体系结构或区域类型的软件包变量。输出通常包括三个列：</para>
<programlisting>NAME (PUBLISHER)       VERSION                IFO
system/core-os         0.5.11-0.175.0.0.0.2.1 i--
x11/wm/fvwm (fvwm.org) 2.6.5                  i--</programlisting>
<para>第一列包含软件包的名称。如果安装（或者提供）该软件包的发布者在发布者搜索顺序上不是第一个，则该发布者名称将列在软件包名称的后面，并括在括号中。第二列包含软件包的发行版本和分支版本。有关发行版本和分支版本以及变量的信息，请参见 <literal>pkg</literal>(7) 手册页。</para>
<itemizedlist>
<para>最后一列包含一组标志，用于显示软件包的状态：</para>
<listitem><para><literal>I</literal> 列中的 <literal>i</literal> 表明软件包已安装。</para></listitem>
<listitem><para><literal>F</literal> 列中的 <literal>f</literal> 表明软件包已冻结。</para></listitem>
<listitem><para><literal>O</literal> 列中的 <literal>o</literal> 表明软件包已过时。<literal>O</literal> 列中的 <literal>r</literal> 表明软件包已重命名（一种形式的过时）。</para>
</listitem>
</itemizedlist>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>仅列出指定的软件包。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在列出时省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>a</option></term>
<listitem><para>列出已安装的软件包并列出未安装但可以安装在此映像中的最新版本的软件包。如果软件包得到已安装的 incorporation 和映像变体的允许，则可以安装软件包。如果指定了一个或多个模式，则会列出与指定模式匹配的、得到任何已安装的 incorporation 和映像变体允许的最新版本。如果不使用 <option>a</option>，则仅列出已安装的软件包。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>af</option></term>
<listitem><para>列出所有变量的所有软件包的所有版本，而不管 incorporation 约束或安装状态如何。使用这些选项时，要显式列出某个软件包的最新版本，请在 <replaceable>pkg_fmri_pattern</replaceable> 的版本部分使用 <literal>latest</literal>。例如，指定 <literal>vim@latest</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>g</option> <replaceable>path_or_uri</replaceable></term>
<listitem><para>使用指定的软件包系统信息库或归档文件作为操作的软件包数据源。需要客户机 SSL 证书的系统信息库不能与此选项一起使用。可以多次指定此选项。如果未指定 <option>n</option>，则可使用 <option>g</option> 表示 <option>a</option>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>n</option></term>
<listitem><para>显示所有已知软件包的最新版本，而不管安装状态如何。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>q</option></term>
<listitem>
<para>发生致命错误时不列出任何软件包，而是返回失败。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option></term>
<listitem><para>显示单行短格式，用于提供软件包名称和摘要。此选项可与 <option>a</option>、<option>n</option> 或 <option>u</option> 一起使用。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>u</option></term>
<listitem><para>列出具有更新可用版本的已安装软件包。此选项不能与 <option>g</option> 一起使用。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>v</option></term>
<listitem><para>在第一列中显示完整的软件包 FMRI，包括发布者和完整版本（VERSION 列将消失）。此选项可与 <option>a</option>、<option>n</option> 或 <option>u</option> 一起使用。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-refresh</option></term>
<listitem><para>不尝试联系映像发布者的系统信息库来检索最新的可用软件包列表。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg info</command> [<option>lqr</option>] [<option>g</option> <replaceable>path_or_uri</replaceable>]... [<option>-license</option>] [<replaceable>pkg_fmri_pattern</replaceable> ...]</term>
<listitem><para>以用户可读的格式显示当前映像中安装的所有软件包的相关信息。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>仅显示指定软件包的相关信息。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>g</option> <replaceable>path_or_uri</replaceable></term>
<listitem><para>使用指定的软件包系统信息库或归档文件作为操作的软件包数据源。需要客户机 SSL 证书的系统信息库不能与此选项一起使用。可以多次指定此选项。使用 <option>g</option> 表示 <option>r</option>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>l</option></term>
<listitem><para>仅显示已安装的软件包的相关信息。这是缺省值。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>q</option></term>
<listitem>
<para>发生致命错误时不显示任何软件包信息，而是返回失败。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>r</option></term>
<listitem><para>根据最新的可用版本匹配软件包，并从包含映像中已配置发布者的系统信息库中检索当前未安装的软件包的相关信息（如有必要）。使用此选项时，必须至少指定一个软件包。如果不指定 <option>r</option>，则缺省情况下仅显示已安装的软件包。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-license</option></term>
<listitem><para>显示软件包的许可证文本。此选项可与 <option>l</option>、<option>q</option> 或 <option>r</option> 结合使用。如果所有 <replaceable>pkg_fmri_pattern</replaceable> 模式都匹配已知软件包并具有许可证，则返回成功。如果一个或多个模式是不匹配的或者与没有许可证的软件包匹配，则返回失败。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg contents</command> [<option>Hmr</option>] [<option>a</option> <replaceable>attribute</replaceable>=<replaceable>pattern</replaceable>]... [<option>g</option> <replaceable>path_or_uri</replaceable>]... [<option>o</option> <replaceable> attribute</replaceable>[,<replaceable>attribute</replaceable>]...]... [<option>s</option> <replaceable> sort_key</replaceable>] [<option>t</option> <replaceable>action_name</replaceable>[,<replaceable> action_name</replaceable>]...]... [<replaceable>pkg_fmri_pattern</replaceable> ...] </term>
<listitem><para>显示映像中安装的所有软件包的内容（操作属性）。未指定选项时，显示当前映像中安装的操作的 <literal>path</literal> 属性值，按属性值的字母顺序排列。如果未指定 <option>o</option> 选项，将改为显示相关操作名称的关键属性（如 <literal>pkg</literal>(7) 中所述）。此外，'depend' 操作还将包括 'type' 属性，'set' 操作将包括 'value' 属性。</para>
<para>指定多个操作名称时，缺省属性是所有指定操作的所有属性集，如上所述。有关操作及其属性的信息，请参见 <literal>pkg</literal>(7) 手册页中的“操作”。另请参见以下伪属性名称列表。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>仅显示指定软件包的内容。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在输出中省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>a</option> <replaceable>attribute</replaceable>=<replaceable> pattern</replaceable></term>
<listitem><para>将输出限制为以下操作：其在选项参数中命名了 <replaceable>attribute </replaceable> 并具有与选项参数中的 (glob) <replaceable>pattern</replaceable> 匹配的值。可以多次指定此选项。如果指定了多个 <option>a</option> 选项，则会显示与其中任一选项匹配的操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>g</option> <replaceable>path_or_uri</replaceable></term>
<listitem><para>显示指定软件包系统信息库或归档文件中可以安装在此映像中的软件包的信息。需要客户机 SSL 证书的系统信息库不能与此选项一起使用。可以安装的软件包包含当前已安装的软件包以及其他满足此映像安装条件（例如变量和侧面限制）的软件包。可以多次指定此选项。使用 <option>g</option> 表示 <option>r</option>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>m</option></term>
<listitem><para>显示指定软件包中所有操作的所有属性，包括无法安装在此映像中的操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>o</option> <replaceable>attribute</replaceable></term>
<listitem><para>显示指定属性，按列出的第一个属性的值排序。可以多次指定 <option>o</option> 选项；也可以通过使用逗号分隔属性名称，将多个属性指定为一个 <option>o</option> 选项的参数。仅显示包含所请求属性的操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>r</option></term>
<listitem><para>显示此映像中配置的发布者系统信息库中可以安装在此映像中的软件包的最新可用版本信息。可以安装的软件包包含当前已安装的软件包以及其他满足此映像安装条件（例如变量和侧面限制）的软件包。使用此选项时，必须至少指定一个软件包。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>sort_key</replaceable></term>
<listitem><para>按指定的操作属性对操作进行排序。如果未提供此选项，则缺省设置是按照路径进行排序或者按照 <option>o</option> 选项指定的第一个属性进行排序。可以多次指定 <option>s</option> 选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>t</option> <replaceable>action_name</replaceable></term>
<listitem><para>仅列出指定的操作。可以多次指定 <option>t</option> 选项；也可以通过使用逗号分隔操作名称，将多个操作指定为一个 <option>t</option> 选项的参数。<replaceable>action_name</replaceable> 的值是 <literal>pkg</literal>(7) 手册页的“操作”中列出的操作之一，例如 <literal>file</literal>、<literal>directory</literal>、<literal>driver</literal>、<literal>depend</literal>、<literal>set</literal>。</para>
</listitem>
</varlistentry>
</variablelist>
<para>为方便起见，可以使用多个特殊的伪属性名称：</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>action.hash</literal></term>
<listitem><para>操作的散列值（如果该操作承载了有效负荷）。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>action.key</literal></term>
<listitem><para>该操作的关键属性值。例如，对于 <literal>file</literal> 操作，关键属性是文件的路径。某些操作不具备关键属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>action.name</literal></term>
<listitem><para>操作的名称。例如，对于某个文件操作，这是 <literal>file</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>action.raw</literal></term>
<listitem><para>匹配操作的所有属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>pkg.fmri</literal></term>
<listitem><para>包含操作的软件包的完整 FMRI，例如 <literal>pkg://solaris/group/feature/amp@0.5.11,5.11-0.175.0.0.0.2.1:20120705T153434Z</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>pkg.name</literal></term>
<listitem><para>包含操作的软件包的名称，例如 <literal>web/amp</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>pkg.publisher</literal></term>
<listitem><para>包含操作的软件包的发布者，例如 <literal>solaris</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>pkg.shortfmri</literal></term>
<listitem><para>包含操作的软件包的短格式 FMRI，例如 <literal>pkg://solaris/group/feature/amp@0.5.11,5.11-0.175</literal>。</para>
</listitem>
</varlistentry>
</variablelist>
<para><command>contents</command> 和 <command>search</command> 子命令是彼此相关的：两者都可在系统中查询软件包的内容。<command>contents</command> 子命令显示一个或多个已安装或可安装软件包中的操作，根据指定的选项过滤输出。<command>search</command> 子命令从另一个方向处理查询，显示包含用户提供的标记的所有软件包的名称。</para>
<para>每个子命令都能够表达另一个子命令也能表达的某些查询。应该谨慎选择所需的子命令，因为使用其中一个子命令来表达某个给定查询，可能比使用另一个子命令更为自然。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg search</command> [<option>HIaflpr</option>] [<option>o</option> <replaceable>attribute</replaceable>[,<replaceable>attribute</replaceable>]...]... [<option>s</option> <replaceable>repo_uri</replaceable>] <replaceable>query</replaceable></term>
<listitem><para>搜索匹配 <replaceable>query</replaceable> 的操作，并显示匹配的搜索索引、操作名称、操作值和软件包名称。请参见下文的 <replaceable>query</replaceable> 说明。某些搜索可能会产生重复结果。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>H</option></term>
<listitem><para>在输出中省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>I</option></term>
<listitem><para>使用区分大小写的搜索。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>a</option></term>
<listitem><para>执行搜索并显示有关匹配操作的信息。这是缺省值。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>f</option></term>
<listitem><para>显示所有结果，而不考虑软件包版本。缺省情况下，<command>search</command> 会删改低于当前安装版本的软件包中的结果，以及当前 incorporation 排除的软件包版本中的结果。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>l</option></term>
<listitem><para>搜索映像的已安装软件包。</para>
<para>可以同时指定 <option>l</option> 和 <option>r</option>（或 <option>s</option>），在此情况下，将会同时执行本地搜索和远程搜索。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>o</option> <replaceable>attribute</replaceable></term>
<listitem><para>指定要在输出中包含的列。可以多次指定 <option>o</option> 选项；也可以通过使用逗号分隔属性名称，将多个属性指定为一个 <option>o</option> 选项的参数。除了上面概述的伪属性外，还为搜索结果定义了下列属性。这些属性有助于说明匹配特定结果的原因：</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>search.match</literal></term>
<listitem><para>与搜索查询匹配的字符串。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>search.match_type</literal></term>
<listitem><para>包含与搜索查询匹配的字符串的属性。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><option>p</option></term>
<listitem><para>显示其某些操作与每个查询词匹配的软件包。使用此选项相当于在查询中的每个词两侧添加尖括号 (<literal>&lt;&gt;</literal>)。有关 <literal>&lt;></literal> 运算符的更多说明，请参见下文的 <replaceable>query</replaceable>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>r</option></term>
<listitem><para>搜索对应于映像发布者的系统信息库。这是缺省值。</para>
<para>可以同时指定 <option>l</option> 和 <option>r</option>（或 <option>s</option>），在此情况下，将会同时执行本地搜索和远程搜索。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>repo_uri</replaceable></term>
<listitem><para>搜索位于给定 URI 的 <literal>pkg</literal>(7) 系统信息库。可以多次指定此选项。不支持软件包归档。</para>
</listitem>
</varlistentry>
<varlistentry><term><replaceable>query</replaceable></term>
<listitem><para>缺省情况下，会将 <replaceable>query</replaceable> 解释为要精确匹配的一系列条件（多个条件用 AND 连接）。</para>
<para>支持 AND 和 OR。</para>
<para>可将 <literal>?</literal> 和 <literal>*</literal> 字符用作 <literal>glob</literal>(3C) 式通配符，以更灵活地获取查询匹配项。</para>
<para>除了支持简单的标记匹配和通配符搜索外，还支持更复杂的查询语言。可通过使用单引号或双引号（<literal>'</literal> 或 <literal>"</literal>）来搜索短语。请务必考虑所用的 shell，使 <command>pkg</command> 能够真正识别 <literal>'</literal> 或 <literal>"</literal>。</para>
<para>要为哪些标记建立索引是与操作相关的，不过可以包括内容散列和路径名称。有关操作及其属性的信息，请参见 <literal>pkg</literal>(7) 手册页中的“操作”。另请参见上面 <command>pkg contents</command> 和 <option>o</option> 中的伪属性名称列表。</para>
<para>结构化查询支持以下语法：</para>
<programlisting><replaceable>pkg_name</replaceable>:<replaceable>action_name</replaceable>:<replaceable>
index</replaceable>:<replaceable>token</replaceable></programlisting>
<para><replaceable>action_name</replaceable> 的值是 <literal>pkg</literal>(7) 手册页的“操作”中列出的操作之一。<replaceable>index</replaceable> 是操作的属性。<replaceable>index</replaceable> 的值必须与 <replaceable>token</replaceable> 匹配。</para>
<para>并非所有操作属性都是可搜索的。例如，<literal>mode</literal> 是 <literal>file</literal> 操作的一个属性，但是 <literal>mode</literal> 不是 <replaceable>index</replaceable> 的有效值。</para>
<para><replaceable>index</replaceable> 的某些值并不是操作属性，而是从其他属性派生的值。例如，<replaceable>index</replaceable> 可以是 <literal>basename</literal>，其不是任何操作的属性，而是派生自 <literal>file</literal> 或 <literal>dir</literal> 操作的 <literal>path</literal> 属性，它采用了路径的最后组成部分。</para>
<para>不同的操作类型有不同的 <replaceable>index</replaceable> 有效值。本文档并未列出所有可能的值。一些更为有用的 <replaceable>index</replaceable> 值包括，对应于文件系统操作的 <literal>basename</literal> 和 <literal>path</literal>、对应于 <literal>depend</literal> 操作的依赖性类型（例如 <literal>require</literal>、<literal>optional</literal>、<literal>group</literal>），以及对应于 <literal>driver</literal> 操作的 <literal>driver_name</literal> 和 <literal>alias</literal>。</para>
<para><replaceable>index</replaceable> 的一个特殊值是对应于 <literal>set</literal> 操作的 <literal>name</literal> 属性值。在这种情况下，<replaceable>token</replaceable> 与对应于指定 <literal>name</literal> 属性的 <literal>value</literal> 属性的值相匹配。例如，以下搜索将查找分类为 "Development/Databases" 或 "System/Databases" 的软件包。请参见“示例”部分中查找 SMF 服务的示例。</para>
<screen>$ <userinput>pkg search info.classification:databases</userinput></screen>
<para>结构化查询中缺少的字段使用隐式通配符。搜索 <literal>basename:pkg</literal> 将会匹配 <replaceable>index</replaceable> 为 <literal>basename</literal> 且与 <replaceable>token</replaceable> <literal>pkg</literal> 匹配的所有软件包中的所有操作，如以下部分输出中所示：</para>
<screen>$ <userinput>pkg search basename:pkg</userinput>
INDEX    ACTION VALUE         PACKAGE
basename dir    usr/share/pkg pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1
basename dir    var/sadm/pkg  pkg:/package/svr4@0.5.11-0.175.0.0.0.2.1
basename dir    var/spool/pkg pkg:/package/svr4@0.5.11-0.175.0.0.0.2.1
basename file   usr/bin/pkg   pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1</screen>
<para>添加其他字段将会缩小搜索范围，如以下完整输出中所示：</para>
<screen>$ <userinput>pkg search file:basename:pkg</userinput>
INDEX    ACTION VALUE       PACKAGE
basename file   usr/bin/pkg pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1</screen>
<para><replaceable>pkg_name</replaceable> 和 <replaceable>token</replaceable> 字段中支持显式通配符。<replaceable>action_name</replaceable> 和 <replaceable>index</replaceable> 必须完全匹配。</para>
<para>有关搜索文件和依赖项的示例，请参见“示例”部分。</para>
<para>要将操作转换为包含这些操作的软件包，请使用 <literal>&lt;></literal>，如以下部分输出中所示：</para>
<screen>$ <userinput>pkg search &bsol;&lt;pkg&bsol;></userinput>
PACKAGE                                  PUBLISHER
pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1  solaris
pkg:/package/svr4@0.5.11-0.175.0.0.0.2.1 solaris</screen>
<para>使用 <option>a</option> 选项（缺省设置）时，搜索 <literal>token</literal> 会导致返回与 <literal>token</literal> 匹配的操作的信息，而搜索 <literal>&lt;token></literal> 会导致返回一个软件包列表，这些软件包包含与 <literal>token</literal> 匹配的操作。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg verify</command> [<option>Hqv</option>] [<option>p</option> <replaceable>path</replaceable>]... [<option>-parsable</option> <replaceable>version</replaceable>] [<option>-unpackaged</option>] [<option>-unpackaged-only</option>] [<replaceable>pkg_fmri_pattern</replaceable> ...]</term>
<listitem><para>验证当前映像中安装的所有软件包的安装情况。如果相关发布者的当前签名策略不是 <literal>ignore</literal>，则会根据策略验证每个软件包的签名。有关如何应用签名策略的说明，请参见下文“映像属性”中的 <literal>signature-policy</literal>。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>仅验证当前映像中安装的指定软件包的安装情况。与 <option>p</option> 配合使用时，将仅验证指定软件包中的匹配操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在验证输出中省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>v</option></term>
<listitem><para>包括有关软件包的信息性消息。另请参见对上述安装命令的 <option>v</option> 选项的说明。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>p</option> <replaceable>path</replaceable></term>
<listitem><para>通过指定路径验证单个文件、链接或目录。指定的路径假定为相对于在其上执行验证的映像的 <literal>/</literal>。如果指定目录或链接，将仅验证该目录或链接的匹配操作。</para>
<para>如果指定路径时未提供 <replaceable>pkg_fmri_pattern</replaceable>，将验证映像中安装的软件包中的所有匹配操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-parsable</option> <replaceable>version</replaceable></term>
<listitem><para>可解析的输出。支持的版本是 0。使用此选项表示 <option>-q</option>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-unpackaged</option></term>
<listitem><para>除了常规输出之外，还报告未打包内容。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-unpackaged-only</option></term>
<listitem><para>仅报告未打包内容。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg fix</command> [<option>HnvqP</option>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be</option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name</option> <replaceable>name</replaceable>] [<option>-accept</option>] [<option>-licenses</option>] [<option>-parsable</option> <replaceable>version</replaceable>] [<option>-unpackaged</option>] [<replaceable>pkg_fmri_pattern</replaceable> ...]</term>
<listitem><para>修复 <command>pkg verify</command> 报告的任何错误。已安装软件包内容的验证基于定制的内容分析，该分析可能会返回与其他程序不同的结果。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>仅修复 <command>pkg verify</command> 报告的有关当前映像中安装的指定软件包的错误。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在验证输出中省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>v</option></term>
<listitem><para>包括有关软件包的信息性消息。另请参见对上述安装命令的 <option>v</option> 选项的说明。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-accept</option></term>
<listitem><para>表示同意并接受所更新或安装的软件包的许可证条款。如果存在任何需要您接受的软件包许可证，而您未提供此选项，则操作将失败。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-licenses</option></term>
<listitem><para>显示在此操作过程中所安装或更新的软件包的所有许可证。对于更新的软件包，仅当许可证已更改时才显示许可证。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-parsable</option> <replaceable>version</replaceable></term>
<listitem><para>可解析的输出。支持的版本是 0。使用此选项表示 <option>-q</option>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-unpackaged</option></term>
<listitem><para>除了常规输出之外，还报告未打包内容。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg revert</command> [<option>nv</option>] [<option> -no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be </option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name </option> <replaceable>name</replaceable>] (<option>-tagged</option> <replaceable> tag-name</replaceable> ... | <replaceable>path-to-file</replaceable> ...)</term>
<listitem><para>将 <literal>pkg</literal>(7) 软件包提供的文件恢复为其交付时的状态。文件所有权和保护也会得到恢复。</para>
<caution><para>将某些可编辑文件恢复为其缺省值可能会使系统无法引导，或导致其他故障。</para></caution>
<variablelist termlength="wholeline">
<varlistentry><term><option>-tagged</option> <replaceable>tag-name</replaceable></term>
<listitem><para>恢复使用 <replaceable>tag-name</replaceable> 标记的所有文件，并删除带有此标记的目录下匹配 <replaceable>pattern</replaceable> 的所有未打包的文件或目录。有关 <literal>tag-name</literal> 和 <replaceable>pattern</replaceable> 的更多信息，请参见 <literal>pkg</literal>(7) 手册页“文件操作”和“目录操作”中对 <literal>revert-tag</literal> 属性的说明。</para>
</listitem>
</varlistentry>
<varlistentry><term><replaceable>path-to-file</replaceable></term>
<listitem><para>恢复指定的文件。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg mediator</command> [<option>aH</option>] [<option>F</option> <replaceable>format</replaceable>] [<replaceable>mediator</replaceable> ...] </term>
<listitem><para>显示所有中介的当前选定版本和/或实现。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>mediator</replaceable></term>
<listitem><para>仅显示指定中介的当前选定版本和/或实现。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>F</option> <replaceable>format</replaceable></term>
<listitem><para>指定备用输出格式。<replaceable>format</replaceable> 的值可以是 <literal>tsv</literal>（以制表符分隔的值）、<literal>json</literal>（单行 JavaScript 对象表示法）或 json-formatted（格式易于阅读的 JavaScript 对象表示法）。</para></listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在列出时省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>a</option></term>
<listitem><para>列出可为当前安装的软件包设置的中介。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg set-mediator</command> [<option>nv</option>] [<option>I</option> <replaceable>implementation</replaceable>] [<option>V</option> <replaceable>version</replaceable>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be</option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name</option> <replaceable>name</replaceable>] <replaceable>mediator</replaceable> ...</term>
<listitem><para>设置当前映像中指定中介的版本和/或实现。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>I</option> <replaceable>implementation</replaceable></term>
<listitem><para>设置要使用的中介接口的实现。缺省情况下，如果未指定版本，则允许所有实现版本。要指定一个没有版本的实现，请附加 @ 符号。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>v</option> <replaceable>version</replaceable></term>
<listitem><para>设置要使用的中介接口的版本。</para>
</listitem>
</varlistentry>
</variablelist>
<para>如果指定的中介版本和/或实现当前不可用，则会删除使用指定中介的任何链接。</para>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg unset-mediator</command> [<option>nvIV</option>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be </option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name </option> <replaceable>name</replaceable>] <replaceable>mediator</replaceable> ... </term>
<listitem><para>将指定中介的版本和/或实现恢复为系统缺省值。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>I</option></term>
<listitem><para>仅恢复中介接口的实现。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>V</option></term>
<listitem><para>仅恢复中介接口的版本。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg variant</command> [<option>Haiv</option>] [<option>F</option> <replaceable>format</replaceable>] [<replaceable>variant_pattern</replaceable> ...]</term>
<listitem><para>显示在此映像中设置的所有变量的当前值。有关变量的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“侧面和变量”。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>variant_pattern</replaceable></term>
<listitem><para>仅显示在此映像中设置的指定变量的当前值。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>F</option> <replaceable>format</replaceable></term>
<listitem><para>指定备用输出格式。有关说明，请参见 <command>pkg mediator</command> 命令。</para></listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在列出时省略标题。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>a</option></term>
<listitem>
<para>显示映像中显式设置的所有变体以及在已安装软件包中列出的所有变体。<option>a</option> 选项不能与 <option>i</option> 选项一起使用。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>i</option></term>
<listitem>
<para>显示在已安装软件包中列出的所有变体。<option>i</option> 选项不能与 <option>a</option> 选项一起使用。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>v</option></term>
<listitem>
<para>显示可为已安装软件包设置的可能变体值。<option>v</option> 选项可与 <option>a</option> 或 <option>i</option> 选项一起使用。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg change-variant</command> [<option>nvq</option>] [<option>C</option> <replaceable>n</replaceable>] [<option>g</option> <replaceable>path_or_uri</replaceable>]... [<option>r</option> [[<option>z</option> <replaceable>zonename</replaceable>]... | [<option>Z</option> <replaceable>zonename</replaceable>]... ]] [<option>-accept</option>] [<option>-licenses</option>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be</option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name</option> <replaceable>name</replaceable>] [<option>-sync-actuators</option> | <option>-sync-actuators-timeout</option> <replaceable>timeout</replaceable>] <replaceable>variant_name</replaceable>=<replaceable>value</replaceable> ...</term>
<listitem><para>更改在当前映像中设置的指定变量的值。</para>
<para>更改变量的值可能会导致删除、更新或安装某些软件包内容。更改变量值还可能会导致安装、更新或删除整个软件包，以满足新的映像配置。有关变量的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“侧面和变量”。</para>
<para>有关选项的说明，请参见上述 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg facet</command> [<option>Haim</option>] [<option>F</option> <replaceable>format</replaceable>] [<replaceable>facet_pattern</replaceable> ...]</term>
<listitem><para>显示使用 <command>pkg change-facet</command> 命令在此映像中本地设置或从父映像继承（例如非全局区域继承全局区域的侧面设置）的所有侧面的当前值和源。有关侧面的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“侧面和变量”。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>facet_pattern</replaceable></term>
<listitem><para>仅显示在此映像中设置的指定侧面的当前值。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>F</option> <replaceable>format</replaceable></term>
<listitem><para>指定备用输出格式。有关说明，请参见 <command>pkg mediator</command> 命令。</para></listitem>
</varlistentry>
<varlistentry>
<term><option>H</option></term>
<listitem>
<para>在列出时省略标题。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>a</option></term>
<listitem>
<para>显示映像中显式设置的所有侧面以及在已安装软件包中列出的所有侧面。<option>a</option> 选项不能与 <option>i</option> 选项一起使用。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>i</option></term>
<listitem>
<para>显示在已安装软件包中列出的所有侧面。<option>i</option> 选项不能与 <option>a</option> 选项一起使用。</para>
</listitem>
</varlistentry>
<varlistentry>
<term><option>m</option></term>
<listitem>
<para>包括在输出中被屏蔽的侧面。显示一列指示被屏蔽的侧面（如果有）。被屏蔽的侧面是在映像中本地设置（使用 <command>pkg change-facet</command> 命令）且被同名的继承侧面隐藏的侧面。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg change-facet</command> [<option>nvq</option>] [<option>C</option> <replaceable>n</replaceable>] [<option>g</option> <replaceable>path_or_uri</replaceable>]... [<option>r</option> [[<option>z</option> <replaceable>zonename</replaceable>]... | [<option>Z</option> <replaceable>zonename</replaceable>]... ]] [<option>-accept</option>] [<option>-licenses</option>] [<option>-no-be-activate</option>] [<option>-no-backup-be</option> | <option>-require-backup-be</option>] [<option>-backup-be-name</option> <replaceable>name</replaceable>] [<option>-deny-new-be</option> | <option>-require-new-be</option>] [<option>-be-name</option> <replaceable>name</replaceable>] [<option>-sync-actuators</option> | <option>-sync-actuators-timeout</option> <replaceable>timeout</replaceable>] <replaceable>facet_name</replaceable>=(<literal>True</literal>|<literal>False</literal>|<literal>None</literal>) ...</term>
<listitem><para>更改当前映像中设置的指定侧面的值。更改也将发生在继承这些侧面的所有映像中，例如非全局区域。</para>
<para>可以将侧面设置为 <literal>True</literal> 或 <literal>False</literal>。将侧面设置为 <literal>None</literal> 时，系统会将缺省值 <literal>True</literal> 应用于该侧面；因此将安装任何由此侧面约束的操作。有关操作的信息，请参见 <literal>pkg</literal>(7) 手册页中的“操作”。</para>
<para>更改侧面的值可能会导致删除、更新或安装某些软件包内容。更改侧面值还可能会导致安装、更新或删除整个软件包，以满足新的映像配置。有关侧面的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“侧面和变量”。</para>
<para>有关选项的说明，请参见上述 <command>install</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg avoid</command> [<replaceable>pkg_fmri_pattern</replaceable> ...] </term>
<listitem><para>显示每个避免安装的软件包，以及对该软件包存在组依赖性的任何软件包。</para>
<para>如果需要满足 require 依赖性，则会安装避免列表中的软件包。如果删除了该依赖性，则会卸载相应的软件包。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>如果指定的软件包是某个组依赖性的目标，则会通过将匹配指定模式的软件包名称放置在避免列表中来避免安装这些软件包。只能避免安装当前尚未安装的软件包。如果某个软件包当前是某个组依赖性的目标，则卸载该软件包会将它放置在避免列表中。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg unavoid</command> [<replaceable>pkg_fmri_pattern </replaceable> ...]</term>
<listitem><para>显示避免安装的软件包的列表。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>从避免列表中删除指定的软件包。使用此子命令无法删除避免列表中与某个已安装软件包的组依赖性相匹配的软件包。要从避免列表中删除与某个组依赖性相匹配的软件包，请安装该软件包。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg freeze</command> [<option>n</option>] [<option>c</option> <replaceable>reason</replaceable>] [<replaceable>pkg_fmri_pattern</replaceable> ...] </term>
<listitem><para>显示有关当前已冻结软件包的信息：软件包名称、版本、软件包冻结时间以及任何冻结软件包的相关原因。</para>
<para>冻结某个软件包不会阻止删除该软件包。删除软件包时不会显示警告。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>将指定的软件包冻结到指定的版本。如果未提供版本，则必须安装该软件包，然后将它冻结在该已安装版本。冻结一个已经冻结的软件包会将冻结版本替换为新指定的版本。</para>
<para>如果安装或更新冻结的软件包，则其最终版本必须与冻结时使用的版本匹配。例如，如果某个软件包在冻结时的版本为 1.2，则可以将它更新到 1.2.1、1.2.9、1.2.0.0.1，等等。但该软件包的最终版本不能为 1.3 或 1.1。<replaceable>pkg_fmri_pattern</replaceable> 中提供的发布者用于查找匹配的软件包。但是，在冻结过程中不会记录发布者信息。软件包只针对其版本（而不是发布者）进行冻结。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>c</option> <replaceable>reason</replaceable></term>
<listitem><para>记录冻结软件包的 <replaceable>原因</replaceable>。当安装或更新因冻结而不能继续进行时，将会显示该原因。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>n</option></term>
<listitem><para>试运行冻结操作，并显示要冻结的软件包的列表，但不冻结任何软件包。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg unfreeze</command> [<option>n</option>] [<replaceable> pkg_name_pattern</replaceable> ...]</term>
<listitem><para>显示有关当前已冻结软件包的信息：软件包名称、版本、软件包冻结时间以及任何冻结软件包的相关原因。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>pkg_fmri_pattern</replaceable></term>
<listitem><para>从指定的软件包中删除冻结操作施加的约束。将会忽略提供的版本。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>n</option></term>
<listitem><para>试运行解冻操作，并显示要解冻的软件包的列表，但不解冻任何软件包。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg property</command> [<option>H</option>] [<replaceable> propname</replaceable> ...]</term>
<listitem><para>显示所有映像属性的名称和值。有关映像属性的说明，请参见下面的“映像属性”。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>propname</replaceable></term>
<listitem><para>仅显示指定属性的名称和值。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在列出时省略标题。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg set-property</command> <replaceable>propname</replaceable> <replaceable> propvalue</replaceable></term>
<listitem><para>更新现有映像属性或添加新的映像属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg add-property-value</command> <replaceable>propname </replaceable> <replaceable>propvalue</replaceable></term>
<listitem><para>向现有映像属性添加值，或添加新的映像属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg remove-property-value</command> <replaceable>propname </replaceable> <replaceable>propvalue</replaceable></term>
<listitem><para>从现有映像属性中删除值。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg unset-property</command> <replaceable>propname</replaceable> ... </term>
<listitem><para>删除一个或多个现有映像属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg publisher</command> [<option>HPn</option>] [<option>F</option> <replaceable>format</replaceable>] [<replaceable>publisher</replaceable> ...] </term>
<listitem><para>按搜索优先顺序显示所有发布者的列表。为每个发布者显示以下信息：名称、属性（例如非粘性和已禁用）、类型（源或镜像）、联机状态、代理和位置 URI。代理信息在标记为 P 的列下仅显示为 T (true) 或 F (false)。要在 P 列中为具有 T 的发布者显示代理值，请使用 <literal>-F tsv</literal> 选项或指定发布者名称参数。<command>pkg publisher</command> 命令显示的代理是使用 <command>pkg set-publisher</command> 命令的 <option>-proxy</option> 选项来设置的。<command>pkg publisher</command> 命令不显示通过使用 <envar>http_proxy</envar> 环境变量设置的代理。</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>publisher</replaceable></term>
<listitem><para>仅显示指定发布者的详细配置信息。显示的其他信息包括代理 URI、键和每个源或镜像 URI 的证书、客户机 UUID 以及上次更新目录的时间。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>F</option> <replaceable>format</replaceable></term>
<listitem><para>指定备用输出格式。<replaceable>format</replaceable> 的值只能是 <literal>tsv</literal>（Tab Separated Value，制表符分隔值）。</para></listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在列出时省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>P</option></term>
<listitem><para>仅显示发布者搜索顺序中的第一个发布者。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>n</option></term>
<listitem><para>仅显示已启用的发布者。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg set-publisher</command> [-Ped] [<option>c</option> <replaceable>ssl_cert</replaceable>] [<option>k</option> <replaceable>ssl_key</replaceable>] [<option>g</option> <replaceable>origin_to_add</replaceable> | <option>-add-origin</option> <replaceable>origin_to_add</replaceable>]... [<option>G</option> <replaceable>origin_to_remove</replaceable> | <option>-remove-origin</option> <replaceable>origin_to_remove</replaceable>]... [<option>m</option> <replaceable>mirror_to_add</replaceable> | <option>-add-mirror</option> <replaceable>mirror_to_add</replaceable>]... [<option>M</option> <replaceable>mirror_to_remove</replaceable> | <option>-remove-mirror</option> <replaceable>mirror_to_remove</replaceable>]... [<option>-disable</option>] [<option>-enable</option>] [<option>-no-refresh</option>] [<option>-reset-uuid</option>] [<option>-non-sticky</option>] [<option>-sticky</option>] [<option>-search-after</option> <replaceable>publisher</replaceable>] [<option>-search-before</option> <replaceable>publisher</replaceable>] [<option>-search-first</option>] [<option>-approve-ca-cert</option> <replaceable>path_to_CA</replaceable>] [<option>-revoke-ca-cert</option> <replaceable>hash_of_CA_to_remove</replaceable>] [<option>-unset-ca-cert</option> <replaceable>hash_of_CA_to_remove</replaceable>] [<option>-set-property</option> <replaceable>name_of_property</replaceable>=<replaceable>value</replaceable>] [<option>-add-property-value</option> <replaceable>name_of_property</replaceable>=<replaceable>value_to_add</replaceable>] [<option>-remove-property-value</option> <replaceable>name_of_property</replaceable>=<replaceable>value_to_remove</replaceable>] [<option>-unset-property</option> <replaceable>name_of_property_to_delete</replaceable>] [<option>-proxy</option> <replaceable>proxy_to_use</replaceable>] <replaceable>publisher</replaceable></term>
<listitem><para>更新现有发布者，或添加发布者。如果未指定任何影响搜索顺序的选项，则会将新发布者附加到搜索顺序，因此，会最后搜索这些新发布者。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>G</option> <replaceable>origin_to_remove</replaceable></term> <term><option>-remove-origin</option> <replaceable>origin_to_remove</replaceable></term>
<listitem><para>从给定发布者的源列表中删除 URI 或路径。可以使用特殊值 <literal>*</literal> 来删除所有源。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>M</option> <replaceable>mirror_to_remove</replaceable></term> <term><option>-remove-mirror</option> <replaceable>mirror_to_remove</replaceable></term>
<listitem><para>从给定发布者的镜像列表中删除 URI。可以使用特殊值 <literal>*</literal> 来删除所有镜像。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>P</option></term><term><option>-search-first</option></term>
<listitem><para>将指定的发布者设置为搜索顺序中第一个。安装新软件包时，将首先搜索此发布者。对已安装软件包的更新将来自最初提供该软件包的同一发布者，前提是该发布者保持粘滞。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>c</option> <replaceable>ssl_cert</replaceable></term>
<listitem><para>指定客户机 SSL 证书。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>d</option></term><term><option>-disable</option></term>
<listitem><para>禁用发布者。填充软件包列表时，或者执行某些软件包操作（安装、卸载和更新）时，将不使用被禁用的发布者。但是，仍可以设置和查看被禁用的发布者的属性。如果只存在一个发布者，则不能将其禁用。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>e</option></term><term><option>-enable</option></term>
<listitem><para>启用发布者。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>g</option> <replaceable>origin_to_add</replaceable></term> <term><option>-add-origin</option> <replaceable>origin_to_add</replaceable></term>
<listitem><para>将指定的 URI 或路径添加为给定发布者的源。这应该是软件包系统信息库或归档的位置。如果与 <option>-enable</option> 或 <option>-disable</option> 结合使用，将按照指定启用或禁用源。在这种情况下，<literal>*</literal> 可用于启用或禁用所有源。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>k</option> <replaceable>ssl_key</replaceable></term>
<listitem><para>指定客户机 SSL 密钥。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>m</option> <replaceable>mirror_to_add</replaceable></term> <term><option>-add-mirror</option> <replaceable>mirror_to_add</replaceable></term>
<listitem><para>将 URI 添加为给定发布者的镜像。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-add-property-value</option> <replaceable>name_of_property </replaceable>=<replaceable>value_to_add</replaceable></term>
<listitem><para>向现有发布者属性添加值，或添加新的发布者属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-approve-ca-cert</option> <replaceable>path_to_CA</replaceable></term>
<listitem><para>为了验证签名的软件包，将指定的证书添加为受信任的 CA 证书。<command>pkg publisher</command> 命令的详细输出中列出了用户批准的 CA 证书的 PEM 表示形式中的散列。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-refresh</option></term>
<listitem><para>不尝试联系映像发布者的系统信息库来检索最新的可用软件包列表和其他元数据。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-non-sticky</option></term>
<listitem><para>对于最初从此发布者安装的软件包，更新可以从级别比此发布者更高的发布者处获取。与此发布者或同级相邻的所有非粘滞型发布者（无论级别）可以提供更新并满足此发布者提供的软件包的依赖性。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-proxy</option> <replaceable>proxy_to_use</replaceable></term>
<listitem><para>使用指定的代理 URI 检索指定源 (<option>g</option>) 或镜像 (<option>m</option>) 的内容。代理值被存储为发布者配置的一部分，这意味着子映像所使用的系统信息库是自动更新的。此选项不能用于设置验证代理。<replaceable>proxy_to_use</replaceable> 值不能使用 <literal>protocol://user:password@host</literal> 格式。</para>
<para>在运行时，<literal>http_proxy</literal> 或相关环境变量会覆盖此代理设置。有关接受的环境变量名列表，请参见 <literal>curl</literal>(1) 手册页的“环境”部分。如果使用环境变量来设置代理 URI，则必须也将 <literal>svc:/application/pkg/system-repository</literal> SMF 服务的相应代理属性设置为同一值。请参见《<citetitle>在 Oracle Solaris 11.3 中添加和更新软件</citetitle>》中的“指定代理”。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-remove-property-value</option> <replaceable>name_of_property </replaceable>=<replaceable>value_to_remove</replaceable></term>
<listitem><para>从现有发布者属性中删除值。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-reset-uuid</option></term>
<listitem><para>选择一个新的唯一标识符，用于向其发布者标识此映像。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-revoke-ca-cert</option> <replaceable>hash_of_CA_to_remove </replaceable></term>
<listitem><para>为了验证签名的软件包，将具有证书的 PEM 表示形式的给定散列的证书视为已撤销。<command>pkg publisher</command> 命令的详细输出中列出了用户撤销的 CA 证书的散列。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-search-after</option> <replaceable>publisher</replaceable></term>
<listitem><para>更改发布者搜索顺序，以便在此选项中指定的发布者之后搜索添加或修改的发布者。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-search-before</option> <replaceable>publisher</replaceable></term>
<listitem><para>更改发布者搜索顺序，以便在此选项中指定的发布者之前搜索添加或修改的发布者。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-set-property</option> <replaceable>name_of_property</replaceable>=<replaceable> value</replaceable></term>
<listitem><para>更新现有发布者属性或添加新的发布者属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-sticky</option></term>
<listitem><para>对于从此发布者安装的软件包，更新必须也来自此发布者。这是缺省行为。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-unset-ca-cert</option> <replaceable>hash_of_CA_to_remove </replaceable></term>
<listitem><para>为了验证签名的软件包，会从已批准证书列表和已撤销证书列表中删除具有给定散列的证书。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-unset-property</option> <replaceable>name_of_property_to_delete </replaceable></term>
<listitem><para>删除现有的发布者属性。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg set-publisher</command> <option>p</option> <replaceable>repo_uri</replaceable> [-Ped] [<option>c</option> <replaceable>ssl_cert</replaceable>] [<option>k</option> <replaceable>ssl_key</replaceable>] [<option>-non-sticky</option>] [<option>-sticky</option>] [<option>-search-after</option> <replaceable>publisher</replaceable>] [<option>-search-before</option> <replaceable>publisher</replaceable>] [<option>-search-first</option>] [<option>-approve-ca-cert</option> <replaceable>path_to_CA</replaceable>] [<option>-revoke-ca-cert</option> <replaceable>hash_of_CA_to_remove</replaceable>] [<option>-unset-ca-cert</option> <replaceable>hash_of_CA_to_remove</replaceable>] [<option>-set-property</option> <replaceable>name_of_property</replaceable>=<replaceable>value</replaceable>] [<option>-add-property-value</option> <replaceable>name_of_property</replaceable>=<replaceable>value_to_add</replaceable>] [<option>-remove-property-value</option> <replaceable>name_of_property</replaceable>=<replaceable>value_to_remove</replaceable>] [<option>-unset-property</option> <replaceable>name_of_property_to_delete</replaceable>] [<option>-proxy</option> <replaceable>proxy_to_use</replaceable>] [<replaceable>publisher</replaceable>]</term>
<listitem><para>从 <replaceable>repo_uri</replaceable> 系统信息库 URI 中检索发布者配置信息。</para>
<para>如果为此 <command>set-publisher</command> 子命令指定了发布者操作数，则仅添加或更新该发布者。如果未指定发布者，则相应添加或更新 <replaceable>repo_uri</replaceable> 中的所有发布者。</para>
<para>有关选项的说明，请参见上述 <command>set-publisher</command> 命令。与 <option>p</option> 一起使用时，<option>P</option>、<option>-search-first</option>、<option>-search-before</option> 以及 <option>-search-after</option> 选项仅适用于添加的发布者，而不适用于更新的发布者。</para>
<para><option>p</option> 选项不能与以下选项结合使用：<option>g</option>、<option>-add-origin</option>、<option>G</option>、<option>-remove-origin</option>、<option>m</option>、<option>-add-mirror</option>、<option>M</option>、<option>-remove-mirror</option>、<option>-disable</option>、<option>-enable</option>、<option>-no-refresh</option> 或 <option>-reset-uuid</option>。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg unset-publisher</command> <replaceable>publisher </replaceable> ...</term>
<listitem><para>删除与一个或多个指定发布者相关联的配置。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg history</command> [<option>HNl</option>] [<option>n</option> <replaceable>number</replaceable>] [<option>o</option> <replaceable>column</replaceable>[,<replaceable>column</replaceable>]...]... [<option>t</option> <replaceable>time</replaceable> | <replaceable>time</replaceable>-<replaceable>time</replaceable>[,<replaceable>time</replaceable> | <replaceable>time</replaceable>-<replaceable>time</replaceable>]...]...</term>
<listitem><para>显示适用映像的命令历史记录。显示操作的开始时间、操作的名称（例如 <literal>install</literal>）、客户机（例如 <literal>pkg</literal>）和操作的结果（成功或失败）。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>H</option></term>
<listitem><para>在列出时省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>l</option></term>
<listitem><para>显示映像的命令历史记录的长格式。显示的其他信息包括客户机的版本、执行操作的用户的名称、是否创建了新引导环境、操作完成时间和花费的总时间、发出的完整命令以及执行命令时遇到的任何错误。对于 <command>update</command> 等操作，显示已更改软件包的完整 FMRI。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>N</option></term>
<listitem><para>显示发行说明文本。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>n</option> <replaceable>number</replaceable></term>
<listitem><para>仅显示指定数目的最近条目。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>o</option> <replaceable>column</replaceable></term>
<listitem><para>使用指定的列名称显示输出。可以多次指定 <option>o</option> 选项；也可以通过使用逗号分隔列名称，将多个列名称指定为一个 <option>o</option> 选项的参数。有效的列名为：</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>be</literal></term>
<listitem><para>在其上启动此操作的引导环境的名称。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>be_uuid</literal></term>
<listitem><para>在其上启动此操作的引导环境的 <literal>uuid</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>client</literal></term>
<listitem><para>客户端的名称。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>client_ver</literal></term>
<listitem><para>客户端的版本。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>command</literal></term>
<listitem><para>用于此操作的命令行。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>finish</literal></term>
<listitem><para>完成此操作时的时间。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>id</literal></term>
<listitem><para>启动此操作的用户 ID。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>new_be</literal></term>
<listitem><para>此操作创建的新引导环境。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>new_be_uuid</literal></term>
<listitem><para>此操作创建的新引导环境的 <literal>uuid</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>operation</literal></term>
<listitem><para>操作的名称。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>outcome</literal></term>
<listitem><para>此操作的结果摘要。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>reason</literal></term>
<listitem><para>有关此操作的结果的其他信息。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>release_note</literal></term>
<listitem><para>指示此操作是否已生成发行说明。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>snapshot</literal></term>
<listitem><para>执行此操作期间创建的快照。仅当成功完成操作后未自动删除快照时，才会记录此信息。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>start</literal></term>
<listitem><para>启动此操作时的时间。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>time</literal></term>
<listitem><para>执行此操作花费的总时间。对于用时不到一秒的操作，将显示 0:00:00。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>user</literal></term>
<listitem><para>启动此操作的用户名。</para>
</listitem>
</varlistentry>
</variablelist>
<para>如果指定了 <literal>command</literal> 或 <literal>reason</literal> 列，则它们必须是 <option>o</option> 列表中的最后一项，这样才能让输出字段彼此分隔。这两列不能显示在同一个 <command>history</command> 命令中。</para>
<para>如果系统上不再存在该引导环境，则在 <literal>be</literal> 或 <literal>new_be</literal> 值的后面会显示一个星号 (*)。</para>
<para>可通过使用 <literal>be_uuid</literal> 或 <literal>new_be_uuid</literal> 字段查找当前引导环境名称，来获取 <literal>be</literal> 和 <literal>new_be</literal> 的值。如果某个引导环境后来已重命名，随后又被删除，则显示的 <literal>be</literal> 和 <literal>new_be</literal> 值是执行 <command>pkg</command> 操作时记录的值。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>t</option> <replaceable>time</replaceable></term> <term><option>t</option> <replaceable>time</replaceable>-<replaceable>time</replaceable></term>
<listitem><para>显示以逗号分隔列表指定的时间戳（格式为 <literal>%Y-%m-%dT%H:%M:%S</literal>）对应的日志记录（请参见 <literal>strftime</literal>(3C) 手册页）。要指定时间范围，请在开始和完成时间戳之间放置连字符 (<literal>-</literal>)。可以将关键字 <literal>now</literal> 用作当前时间的别名。可以多次指定此选项。如果指定的时间戳包含重复的时间戳或重叠的范围，则不显示重复的历史记录事件。仅显示每个历史记录事件的一个实例。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg purge-history</command></term>
<listitem><para>删除所有现有历史记录信息。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg rebuild-index</command></term>
<listitem><para>重建由 <command>pkg search</command> 使用的索引。这是一项恢复操作，不适用于一般用途。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg update-format</command></term>
<listitem><para>将映像格式更新到当前版本。完成此操作后，该映像无法再在早期版本的 <literal>pkg</literal>(7) 系统上使用。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg version</command></term>
<listitem><para>显示一个用于唯一标识 <command>pkg</command> 版本的字符串。不保证在不同版本中，此字符串在任何方面都具有类似性。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkg help</command> [<option>v</option>]</term>
<listitem><para>显示子命令的完整列表。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>v</option></term>
<listitem><para>显示子命令的详细用法消息。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>

<varlistentry><term><command>pkg image-create</command> [<option>FPUfz</option>] [<option>-force</option>] [<option>-full</option> | <option>-partial</option> | <option>-user</option>] [<option>-zone</option>] [<option>c</option> <replaceable>ssl_cert</replaceable>] [<option>k</option> <replaceable> ssl_key</replaceable>] [<option>g</option> <replaceable>path_or_uri</replaceable> | <option>-origin</option> <replaceable>path_or_uri</replaceable>]... [<option>m</option> <replaceable>uri</replaceable> | <option>-mirror</option> <replaceable>uri</replaceable>]... [<option>-facet</option> <replaceable>facet_name</replaceable>=(<literal>True</literal>|<literal>False</literal>)]... [<option>-no-refresh</option>] [<option>-set-property</option> <replaceable>name_of_property</replaceable>=<replaceable>value</replaceable>] [<option>-variant</option> <replaceable>variant_name</replaceable>=<replaceable>value</replaceable>]... [(<option>p</option> | <option>-publisher</option>) [<replaceable>name</replaceable>=]<replaceable>repo_uri</replaceable>] <replaceable>dir</replaceable></term>
<listitem><para>在 <replaceable>dir</replaceable> 指定的位置，创建一个适合于软件包操作的映像。无法引导使用 <command>image-create</command> 子命令创建的映像。大多数用户应该将 <option>-be-name</option> 或 <option>-require-new-be</option> 选项与 <command>pkg</command> 命令配合使用，或者使用 <command>beadm</command> 或 <command>zoneadm</command> 命令创建映像。<command>pkg image-create</command> 命令用于维护软件包和操作系统分发等任务。</para>
<para>缺省的映像类型为“用户”，可以通过使用 <option>U</option> 或 <option>-user</option> 选项来指定。或者，可以将映像类型设置为完整映像（<option>-F</option> 或 <option>-full</option>），或者设置为与完整映像（包括给定的 <option>dir</option> 路径）链接的部分映像（<option>P</option> 或 <replaceable>-partial</replaceable>）。</para>
<para>可以使用 <option>g</option> 或 <option>-origin</option> 指定其他源。可以使用 <option>m</option> 或 <option>-mirror</option> 指定其他镜像。</para>
<para>必须使用 <option>p</option> 或 <option>-publisher</option> 选项提供软件包系统信息库 URI。如果还提供了某个发布者名称，则创建映像时仅添加该发布者。如果未提供发布者名称，则会将指定的系统信息库已知的所有发布者添加到映像。完成初始创建操作后，将会尝试检索与此发布者关联的目录。</para>
<para>对于使用客户端 SSL 验证的发布者，可以通过 <option>c</option> 和 <option>k</option> 选项注册客户端密钥和客户端证书。此密钥和证书用于映像创建期间添加的所有发布者。</para>
<para>如果要在非全局区域上下文中运行映像，请使用 <option>z</option> (<option>-zone</option>) 选项设置相应的变体。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>f</option></term><term><option>-force</option></term>
<listitem><para>基于现有映像强制创建一个映像。请慎用此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-facet</option> <replaceable>facet_name</replaceable>=(<literal> True</literal>|<literal>False</literal>)</term>
<listitem><para>将指定的侧面设置为指示值。有关侧面的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“侧面和变量”。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-refresh</option></term>
<listitem><para>不尝试联系映像发布者的系统信息库来检索最新的可用软件包列表和其他元数据。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-set-property</option> <replaceable>name_of_property</replaceable>=<replaceable> value</replaceable></term>
<listitem><para>将指定的映像属性设置为指示值。有关映像属性的说明，请参见下面的“映像属性”。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-variant</option> <replaceable>variant_name</replaceable>=<replaceable> value</replaceable></term>
<listitem><para>将指定的变量设置为指示值。有关变量的更多信息，请参见 <literal>pkg</literal>(7) 手册页中的“侧面和变量”。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>

<varlistentry><term><command>pkg <option>R</option> <replaceable>dir</replaceable> dehydrate</command> [<option>nvq</option>] [<option>p</option> <replaceable>publisher</replaceable>]...</term>
<listitem><para>从 <option>R</option> 选项指定的映像中删除所有不可编辑的打包文件和打包硬链接，以创建完全冻结的映像。打包文件和打包硬链接是当前安装的软件包版本提供的文件和硬链接。不可编辑的文件不能具有任何 <literal>preserve</literal> 或 <literal>overlay</literal> 属性，因此其 <literal>dehydrate</literal> 属性的值不能为 <literal>false</literal>。</para>
<para><command>pkg dehydrate</command> 命令仅对备用根运行。使用 <option>R</option> 选项指定备用根。如果备用根属于引导环境，则冻结将使其无法引导。</para>
<para>如果 <command>pkg dehydrate</command> 命令成功，则在 <option>R</option> 选项指定的 <replaceable>dir</replaceable> 映像上设置名为 <command>dehydrated</command> 的属性。<command>dehydrated</command> 属性的值是在具有已配置软件包系统信息库的 <replaceable>dir</replaceable> 映像中设置的所有发布者的列表。</para>
<para>对来自已冻结发布者的软件包的软件包安装操作将自动冻结。如果安装已冻结映像中的软件包，则将安装软件包内容，然后将其冻结。软件包安装操作可包括 <command>update</command> 和 <command>change-facet</command> 以及 <command>install</command> 等操作。</para>
<variablelist termlength="wholeline">
<varlistentry>
<term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>删除指定的发布者提供的不可编辑文件和硬链接以创建部分冻结的映像。如果指定了映像的所有已配置发布者，则如上所述创建完全冻结的映像。</para>
<para>如果指定了一个或多个发布者，且未在映像中配置其中任一发布者，则不会从映像中删除任何内容。</para>
<para>如果 <command>pkg dehydrate</command> 命令成功，则在 <option>R</option> 选项指定的 <replaceable>dir</replaceable> 映像上设置名为 <command>dehydrated</command> 的属性。<command>dehydrated</command> 属性的值是 <option>p</option> 选项指定的所有发布者的列表。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>

<varlistentry><term><command>pkg <option>R</option> <replaceable>dir</replaceable> rehydrate</command> [<option>nvq</option>] [<option>p</option> <replaceable>publisher</replaceable>]...</term>
<listitem><para>重新安装 <command>pkg dehydrate</command> 命令删除的所有文件和硬链接。</para>
<para><command>pkg rehydrate</command> 命令仅对备用根运行。使用 <option>R</option> 选项指定备用根。</para>
<para>如果 <command>pkg rehydrate</command> 命令成功，则映像的 <command>dehydrated</command> 属性的值为空。</para>
<variablelist termlength="wholeline">
<varlistentry>
<term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>针对指定的发布者，重新安装 <command>pkg dehydrate</command> 命令删除的所有文件和硬链接。</para>
<para>如果指定了一个或多个发布者，且未在映像中配置其中任一发布者，则不会安装任何内容。</para>
<para>如果 <command>pkg rehydrate</command> 命令成功，则从映像上设置的 <command>dehydrated</command> 属性的值中删除指定的发布者的名称。<command>rehydrate</command> 命令中未指定的发布者仍列在 <command>dehydrated</command> 属性中，通过这些发布者安装的内容将仍保持冻结状态。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于其他所有选项，请参见上面的 <command>install</command> 命令。</para>
</listitem>
</varlistentry>

</variablelist>
</refsect1>
<refsect1 role="other"><title>映像属性</title>
<para>以下属性可定义映像的特征。这些属性存储有关映像的用途、内容和行为的信息。要查看映像中这些属性的当前值，请使用 <command>pkg property</command> 命令。要修改这些属性的值，请使用 <command>pkg set-property</command> 和 <command>pkg unset-property</command> 命令。</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>be-policy</literal></term>
<listitem><para>（字符串）指定在打包操作期间何时创建引导环境。允许使用以下值：</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>default</literal></term>
<listitem><para>应用缺省引导环境创建策略 <literal>create-backup</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>always-new</literal></term>
<listitem><para>所有软件包操作均需要重新引导：在下次引导时设为活动状态的新引导环境中执行这些操作。除非显式请求，否则不创建备份引导环境。</para>
<para>该策略最为安全，但是它比大多数站点的需要更为严格，因为在不重新引导的情况下无法添加任何软件包。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><literal>create-backup</literal></term>
<listitem><para>对于需要重新引导的软件包操作，在下一次引导时，将创建一个新的引导环境并将其设置为活动状态。如果修改了软件包或安装了可能影响内核的内容，并且该操作影响实时引导环境，将创建备份引导环境，但不会将其设置为活动状态。也可以显式请求创建备份引导环境。</para>
<para>仅当新安装的软件导致系统不稳定时（有可能发生，但比较少见），该策略才可能存在风险。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>when-required</literal></term>
<listitem><para>对于需要重新引导的软件包操作，在下一次引导时，将创建一个新的引导环境并将其设置为活动状态。除非显式请求，否则不创建备份引导环境。</para>
<para>该策略的风险最高，因为如果对实时引导环境的打包更改使得以后无法再进行更改，则可能没有可回退的最近引导环境。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>ca-path</literal></term>
<listitem><para>（字符串）一个路径名称，指向为执行 SSL 操作而将 CA 证书保存到的目录。此目录的格式特定于底层 SSL 实现。要对可信 CA 证书使用替代位置，请将此值更改为指向另一个目录。有关 CA 目录的要求，请参见 <literal>SSL_CTX_load_verify_locations</literal>(3openssl) 的 <literal>CApath</literal> 部分。</para>
<para>缺省值：<literal>/etc/openssl/certs</literal></para>
</listitem>
</varlistentry>
<varlistentry><term><literal>check-certificate-revocation</literal></term>
<listitem><para>（布尔型）如果此属性设置为 <literal>True</literal>，则软件包客户机将尝试访问用于签名验证的证书中的任何 CRL 分发点，以确定证书自颁发以来是否已被撤销。</para>
<para>缺省值：<literal>False</literal></para>
</listitem>
</varlistentry>
<varlistentry><term><literal>content-update-policy</literal></term>
<listitem><para>（字符串）指定在打包操作期间软件包系统何时更新不可编辑的文件。允许使用以下值：</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>default</literal></term>
<listitem><para>始终应用缺省内容更新策略。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>always</literal></term>
<listitem><para>始终下载并更新已更改的不可编辑文件。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>when-required</literal></term>
<listitem><para>仅当软件包系统已确定需要进行更新时，才下载并更新已更改的不可编辑文件。</para>
</listitem>
</varlistentry>
</variablelist>
<para>缺省值：<literal>always</literal></para>
</listitem>
</varlistentry>
<varlistentry><term><literal>flush-content-cache-on-success</literal></term>
<listitem><para>（布尔型）如果此属性设置为 <literal>True</literal>，则映像修改操作成功完成时软件包客户机将删除其内容高速缓存中的文件。对于创建引导环境的操作，将同时从源和目标引导环境中删除内容。</para>
<para>在磁盘空间有限的系统上，可以使用此属性使内容高速缓存保持为较小的大小。此属性可能会导致花费更长的时间来完成操作。</para>
<para>缺省值：<literal>True</literal></para>
</listitem>
</varlistentry>
<varlistentry><term><literal>mirror-discovery</literal></term>
<listitem><para>（布尔型）此属性通知客户端使用 mDNS 和 DNS-SD 发现本地链路内容镜像。如果此属性设置为 <literal>True</literal>，则客户机尝试从其动态发现的镜像中下载软件包内容。要运行一个通过 mDNS 通告其内容的镜像，请参见 <command>pkg.depotd</command>(8) 手册页。</para>
<para>缺省值：<literal>False</literal></para>
</listitem>
</varlistentry>
<varlistentry><term><literal>send-uuid</literal></term>
<listitem><para>（布尔型）执行网络操作时发送映像的通用唯一标识符 (Universally Unique Identifier, UUID)。尽管用户可以禁用此选项，但是某些网络系统信息库可能会拒绝与不提供 UUID 的客户机通信。</para>
<para>缺省值：<literal>True</literal></para>
</listitem>
</varlistentry>
<varlistentry><term><literal>signature-policy</literal></term>
<listitem><para>（字符串）确定在映像中安装、更新、修改或验证软件包时，要对清单执行哪些检查。应用于软件包的最终策略取决于映像策略和发布者策略的组合。该策略组合的严格程度至少相当于这两个策略单独执行时较严格的那一个。缺省情况下，软件包客户机不检查证书是否已撤销。要启用这些检查（可能需要客户机访问外部 Internet 站点），请将 <literal>check-certificate-revocation</literal> 映像属性设置为 <literal>True</literal>。允许使用以下值：</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>ignore</literal></term>
<listitem><para>忽略所有清单的签名。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>verify</literal></term>
<listitem><para>验证所有具有签名的清单的签名是否有效，但不要求签名所有安装的软件包。这是缺省值。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>require-signatures</literal></term>
<listitem><para>要求所有新安装的软件包至少具有一个有效签名。如果安装的软件包不具备有效签名，<command>pkg fix</command> 和 <command>pkg verify</command> 命令也会发出警告。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>require-names</literal></term>
<listitem><para>与 <literal>require-signatures</literal> 遵循相同的要求，但还要求 <literal>signature-required-names</literal> 属性中列出的字符串显示为用于验证签名信任链的证书的通用名称。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><literal>signature-required-names</literal></term>
<listitem><para>（字符串列表）在验证软件包签名时必须视为证书通用名称的名称列表。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>trust-anchor-directory</literal></term>
<listitem><para>（字符串）包含映像信任锚的目录的路径名称。此路径是映像的相对路径。缺省值为 <literal>ignore</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>use-system-repo</literal></term>
<listitem><para>（布尔型）此属性指示映像是否应使用系统信息库作为映像和发布者配置的源，以及作为与提供的发布者通信的代理。缺省值为 <literal>False</literal>。有关系统信息库的信息，请参见 <command>pkg.sysrepo</command>(8) 手册页。</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 role="other"><title>发布者属性</title>
<para>以下属性定义了特定发布者的签名策略。具有相同名称的映像属性定义了该映像的签名策略。要查看特定发布者的这些属性的当前值，请使用 <command>pkg publisher</command> <replaceable>publisher_name</replaceable> 命令。要修改发布者的这些签名策略属性的值，请使用 <command>pkg set-publisher</command> 命令的 <option>-set-property</option> 和 <option>-unset-property</option> 选项。</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>signature-policy</literal></term>
<listitem><para>（字符串）此属性的作用与同名映像属性的功能相同，不过它仅适用于来自特定发布者的软件包。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>signature-required-names</literal></term>
<listitem><para>（字符串列表）此属性的作用与同名映像属性的功能相同，不过它仅适用于来自特定发布者的软件包。</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 role="examples"><title></title>
<example><title>在配置了发布者的情况下创建映像</title>
<para>使用 <literal>/aux0/example_root</literal> 中存储的发布者 <literal>example.com</literal> 创建一个新的完整映像。</para>
<screen>$ <userinput>pkg image-create -F -p example.com=http://pkg.example.com:10000 &bsol;</userinput>
<userinput>/aux0/example_root</userinput></screen>
</example>
<example id="GLGIN"><title>创建一个映像并指定附加源和镜像</title>
<para>使用发布者 <literal>example.com</literal> 创建一个新的完整映像。该映像还有一个附加镜像、两个附加源，并存储在 <literal>/aux0/example_root</literal> 中。</para>
<screen>$ <userinput>pkg image-create -F -p example.com=http://pkg.example.com:10000 &bsol;</userinput>
<userinput>-g http://alternate1.example.com:10000/ &bsol;</userinput>
<userinput>-g http://alternate2.example.com:10000/ &bsol;</userinput>
<userinput>-m http://mirror.example.com:10000/ &bsol;</userinput>
<userinput>/aux0/example_root</userinput></screen>
</example>
<example><title>在未配置发布者的情况下创建映像</title>
<para>在未配置发布者的情况下，在 <literal>/aux0/example_root</literal> 中创建一个新的完整映像。</para>
<screen>$ <userinput>pkg image-create -F /aux0/example_root</userinput></screen>
</example>
<example><title>安装软件包</title>
<para>在当前映像中安装最新版本的 <literal>widget</literal> 软件包。</para>
<screen>$ <userinput>pkg install application/widget</userinput></screen>
</example>
<example><title>列出软件包的指定内容</title>
<para>列出 <literal>system/file-system/zfs</literal> 软件包的内容。显示操作名称、文件模式（如果已定义）、大小（如果已定义）、路径和目标（如果为链接）。将操作限制为类型 <literal>dir</literal>、<literal>file</literal>、<literal>link</literal> 和 <literal>hardlink</literal>，因为指定可用于所有操作的 <literal>action.name</literal> 属性将显示一个列出了所有操作的行，而此处并不需要显示它。</para>
<screen>$ <userinput>pkg contents -t dir,file,link,hardlink &bsol;</userinput>
<userinput>-o action.name,mode,pkg.size,path,target system/file-system/zfs</userinput>
ACTION.NAME MODE PKG.SIZE PATH                 TARGET
dir         0755          etc
dir         0755          etc/fs
dir         0755          etc/fs/zfs
link                      etc/fs/zfs/mount     ../../../usr/sbin/zfs
link                      etc/fs/zfs/umount    ../../../usr/sbin/zfs
dir         0755          etc/zfs
dir         0755          kernel
dir         0755          kernel/drv
dir         0755          kernel/drv/amd64
file        0755  1706744 kernel/drv/amd64/zfs
file        0644      980 kernel/drv/zfs.conf
dir         0755          kernel/fs
dir         0755          kernel/fs/amd64
hardlink                  kernel/fs/amd64/zfs  ../../../kernel/drv/amd64/zfs
...</screen>
</example>
<example><title>列出两个软件包的指定内容</title>
<para>列出 <literal>web/browser/firefox</literal> 和 <literal>mail/thunderbird </literal> 的内容，将显示的内容仅限于软件包名称，以及其 <literal>path</literal> 属性以 <filename>.desktop</filename> 或 <filename>.png</filename> 结尾的操作的路径属性。</para>
<screen>$ <userinput>pkg contents -o pkg.name,path -a path=&bsol;*.desktop &bsol;</userinput>
<userinput>-a path=&bsol;*.png web/browser/firefox mail/thunderbird</userinput>
PKG.NAME            PATH
web/browser/firefox usr/share/applications/firefox.desktop
mail/thunderbird    usr/share/applications/thunderbird.desktop
web/browser/firefox usr/share/pixmaps/firefox-icon.png
mail/thunderbird    usr/share/pixmaps/thunderbird-icon.png
...</screen>
</example>
<example><title>搜索软件包</title>
<para>在软件包数据库中搜索标记 <literal>bge</literal>。</para>
<screen>$ <userinput>pkg search bge</userinput>
INDEX       ACTION VALUE                                 PACKAGE
driver_name driver bge                                   pkg:/driver/network/ethernet/bge@0.5.11-0.175.0.0.0.2.1
basename    file   kernel/drv/sparcv9/bge                pkg:/driver/network/ethernet/bge@0.5.11-0.175.0.0.0.2.1
basename    file   kernel/drv/amd64/bge                  pkg:/driver/network/ethernet/bge@0.5.11-0.175.0.0.0.2.1
basename    file   platform/sun4v/kernel/drv/sparcv9/bge pkg:/system/kernel/platform@0.5.11-0.175.0.0.0.2.1
pkg.fmri    set    solaris/driver/network/bge            pkg:/driver/network/bge@0.5.11-0.173.0.0.0.1.0
pkg.fmri    set    solaris/driver/network/ethernet/bge   pkg:/driver/network/ethernet/bge@0.5.11-0.175.0.0.0.2.1
</screen>
<para>该标记在软件包 <literal>driver/network/bge</literal> 中，既用作代表 <filename>/kernel/drv/<replaceable> arch</replaceable>/bge</filename> 的文件操作的基名，又用作驱动程序名称。</para>
</example>
<example id="GMEDQ"><title>搜索文件</title>
<para>要搜索提供某个文件的软件包，请指定该文件的全路径名，包括开头的斜杠字符。</para>
<screen>$ <userinput>pkg search -o path,pkg.name -l /usr/bin/vim</userinput>
PATH         PKG.NAME
usr/bin/vim  editor/vim/vim-core</screen>
<para>要搜索某个文件和提供该文件的软件包，请指定 <literal>file</literal>（对于 <replaceable>action_name</replaceable>）、<literal>path</literal> 或 <literal>basename</literal>（对于 <replaceable>index</replaceable>），以及完整或部分文件名（对于 <replaceable>token</replaceable>）。</para>
<screen>$ <userinput>pkg search -o path,pkg.name -l file:basename:vim</userinput>
PATH         PKG.NAME
usr/bin/vim  editor/vim/vim-core</screen>
</example>
<example id="GMECW"><title>搜索文件和目录</title>
<para>要搜索文件和目录以及提供它们的软件包，请指定 <literal>path</literal> 或 <literal>basename</literal>（对于 <replaceable>index</replaceable>）以及完整或部分文件名（对于 <replaceable>token</replaceable>）。根据您的 shell，您可能需要对通配符进行转义。</para>
<screen>$ <userinput>pkg search -o path,pkg.name -l path:*/vim</userinput>
PATH           PKG.NAME
usr/bin/vim    editor/vim/vim-core
usr/share/vim  editor/vim
usr/share/vim  editor/vim/vim-core
$ <userinput>pkg search -o path,pkg.name -l basename:vim</userinput>
PATH           PKG.NAME
usr/share/vim  editor/vim
usr/share/vim  editor/vim/vim-core
usr/bin/vim    editor/vim/vim-core</screen>
</example>
<example id="GMEGA"><title>显示哪些软件包提供特定的 SMF 服务</title>
<para>要显示哪些软件包提供特定的 SMF 服务，请在结构化搜索中为 <replaceable>index</replaceable> 指定 <literal>org.opensolaris.smf.fmri</literal> 值，并为 <replaceable>token</replaceable> 指定要查找的服务名称。<literal>org.opensolaris.smf.fmri</literal> 值是 <literal>set</literal> 操作的某个属性的名称。请注意对服务名称中的 : 进行转义。</para>
<para>例如，要显示哪些 HTTP 服务器可用，请为 <replaceable>token</replaceable> 指定 <literal>svc:/network/http</literal> 值。</para>
<screen>$ <userinput>pkg search 'org.opensolaris.smf.fmri:svc&bsol;:/network/http*'</userinput>
INDEX                    ACTION VALUE                        PACKAGE
org.opensolaris.smf.fmri set    svc:/network/http            pkg:/web/server/lighttpd-14@1.4.23-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http            pkg:/web/proxy/privoxy@3.0.17-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http            pkg:/web/proxy/squid@3.1.18-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http            pkg:/web/java-servlet/tomcat@6.0.35-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http            pkg:/web/server/apache-22@2.2.22-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http:apache22   pkg:/web/server/apache-22@2.2.22-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http:lighttpd14 pkg:/web/server/lighttpd-14@1.4.23-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http:privoxy    pkg:/web/proxy/privoxy@3.0.17-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http:squid      pkg:/web/proxy/squid@3.1.18-0.175.0.0.0.2.1
org.opensolaris.smf.fmri set    svc:/network/http:tomcat6    pkg:/web/java-servlet/tomcat@6.0.35-0.175.0.0.0.2.1
</screen>
</example>
<example><title>搜索依赖于指定软件包的软件包</title>
<para>搜索依赖于 <literal>package/pkg</literal> 的已安装软件包。</para>
<screen>$ <userinput>pkg search -l depend::package/pkg</userinput>
INDEX       ACTION VALUE                                    PACKAGE
incorporate depend package/pkg@0.5.11-0.175.0.0.0.2.1      pkg:/consolidation/ips/ips-incorporation@0.5.11-0.175.0.0.0.2.1
require     depend pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1 pkg:/system/library/install@0.5.11-0.175.0.0.0.2.1
require     depend pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1 pkg:/system/library/boot-management@0.5.11-0.175.0.0.0.2.1
require     depend package/pkg                             pkg:/system/zones/brand/brand-solaris@0.5.11-0.175.0.0.0.2.1
require     depend pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1 pkg:/install/distribution-constructor@0.5.11-0.175.0.0.0.2.1
require     depend pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1 pkg:/system/boot-environment-utilities@0.5.11-0.175.0.0.0.2.1
require     depend pkg:/package/pkg@0.5.11-0.175.0.0.0.2.1 pkg:/package/pkg/system-repository@0.5.11-0.175.0.0.0.2.1
</screen>
</example>
<example><title>搜索依赖性</title>
<para>在安装的软件包中搜索所有 <literal>incorporate</literal> 依赖性。</para>
<screen>$ <userinput>pkg search -l depend:incorporate:</userinput>
INDEX       ACTION VALUE                                PACKAGE
incorporate depend pkg:/BRCMbnx@0.5.11-0.175.0.0.0.2.1  pkg:/consolidation/osnet/osnet-incorporation@0.5.11-0.175.0.0.0.2.1
incorporate depend pkg:/BRCMbnxe@0.5.11-0.175.0.0.0.2.1 pkg:/consolidation/osnet/osnet-incorporation@0.5.11-0.175.0.0.0.2.1
...</screen>
</example>
<example><title>添加发布者</title>
<para>添加新的发布者 <literal>example.com</literal>，该发布者的系统信息库位于 <literal>http://www.example.com/repo</literal>。</para>
<screen>$ <userinput>pkg set-publisher -g http://www.example.com/repo example.com</userinput></screen>
</example>
<example><title>添加具有密钥和证书的发布者</title>
<para>添加新的发布者 <literal>example.com</literal>，该发布者的安全系统信息库位于 <literal>https://secure.example.com/repo</literal>，其密钥和证书存储在目录 <literal>/root/creds</literal> 中。</para>
<screen>$ <userinput>pkg set-publisher -k /root/creds/example.key &bsol;</userinput>
<userinput>-c /root/creds/example.cert -g https://secure.example.com/repo &bsol;</userinput>
<userinput>example.com</userinput></screen>
</example>
<example><title>添加并自动配置发布者</title>
<para>使用自动配置功能添加一个新的发布者，该发布者的系统信息库位于 <literal>/export/repo</literal>。</para>
<screen>$ <userinput>pkg set-publisher -p /export/repo</userinput></screen>
</example>
<example><title>添加并手动配置发布者</title>
<para>使用手动配置功能添加新的发布者 <literal>example.com</literal>，该发布者的系统信息库位于 <literal>/export/repo/example.com</literal>。</para>
<screen>$ <userinput>pkg set-publisher -g /export/repo example.com</userinput></screen>
</example>
<example id="GMFJM"><title>添加发布者并配置代理</title>
<para>添加源为 <literal>http://server/repo</literal>、代理为 <literal>http://webcache:8080</literal> 的新发布者 <literal>mypub</literal>。</para>
<screen>$ <userinput>pkg set-publisher -g http://server/repo &bsol;</userinput>
<userinput>--proxy http://webcache:8080 mypub</userinput></screen>
</example>
<example><title>验证所有签名的软件包</title>
<para>配置一个映像以验证所有签名的软件包。</para>
<screen>$ <userinput>pkg set-property signature-policy verify</userinput></screen>
</example>
<example><title>要求签名所有软件包</title>
<para>配置一个映像，以要求签名所有软件包，并要求字符串 <literal>example.com</literal> 显示为信任链中某一个证书的通用名称。</para>
<screen>$ <userinput>pkg set-property signature-policy require-names example.com</userinput></screen>
</example>
<example><title>要求对来自指定发布者的所有软件包进行签名</title>
<para>配置一个映像，以便必须对通过发布者 <literal>example.com</literal> 安装的所有软件包进行签名。</para>
<screen>$ <userinput>pkg set-publisher --set-property signature-policy=require-signatures &bsol;</userinput>
<userinput>example.com</userinput></screen>
</example>
<example><title>要求信任链中存在指定的字符串</title>
<para>将字符串 <literal>foo</literal> 添加到映像的通用名称列表，这些通用名称必须显示在签名的信任链中才能视为有效。</para>
<screen>$ <userinput>pkg add-property-value signature-require-names foo</userinput></screen>
</example>
<example><title>从指定发布者的信任链中删除某个字符串
</title>
<para>从通用名称列表中删除字符串 <literal>foo</literal>，必须显示这些通用名称才能验证发布者 <literal>example.com</literal> 的签名。</para>
<screen>$ <userinput>pkg set-publisher --remove-property-value signature-require-names=foo &bsol;</userinput>
<userinput>example.com</userinput></screen>
</example>
<example><title>添加可信 CA 证书</title>
<para>添加 <literal>/tmp/example_file.pem</literal> 中存储的证书，作为发布者 <literal>example.com</literal> 的可信 CA 证书。</para>
<screen>$ <userinput>pkg set-publisher --approve-ca-cert /tmp/example_file.pem &bsol;</userinput>
<userinput>example.com</userinput></screen>
</example>
<example><title>撤销证书</title>
<para>撤销发布者 <literal>example.com</literal> 的、包含散列 <literal>a12345</literal> 的证书，防止该证书验证来自 <literal>example.com</literal> 的软件包的任何签名。</para>
<screen>$ <userinput>pkg set-publisher --revoke-ca-cert a12345 example.com</userinput></screen>
</example>
<example><title>忘记针对某个证书执行的操作</title>
<para>使 <command>pkg</command> 忘记用户曾经添加或撤销了证书 <literal>a12345</literal>。</para>
<screen>$ <userinput>pkg set-publisher --unset-ca-cert a12345 example.com</userinput></screen>
</example>
<example><title>将软件包降级</title>
<para>将安装的软件包 <literal>foo@1.1</literal> 降级到更低的版本。</para>
<screen>$ <userinput>pkg update foo@1.0</userinput></screen>
</example>
<example><title>切换发生冲突的软件包安装</title>
<para>当两个软件包发生冲突时，切换所安装的软件包。假定软件包 A 依赖于软件包 B 或软件包 C，而 B 和 C 是互斥的。如果安装了 A 和 B，则使用以下命令即可改为使用 C 而不是 B，且无需卸载 A：</para>
<screen>$ <userinput>pkg install --reject B C</userinput></screen>
</example>
<example><title>列出软件包归档中的软件包</title>
<para>列出某个软件包归档中所有软件包的所有版本。</para>
<screen>$ <userinput>pkg list -f -g /my/archive.p5p</userinput></screen>
</example>
<example><title>列出软件包系统信息库中的软件包</title>
<para>列出某个系统信息库中所有软件包的所有版本。</para>
<screen>$ <userinput>pkg list -f -g http://example.com:10000</userinput></screen>
</example>
<example><title>显示有关软件包归档中某个软件包的信息</title>
<para>显示软件包归档中某个软件包的最新版本的软件包信息。该软件包当前不一定已安装。</para>
<screen>$ <userinput>pkg info -g /my/archive.p5p pkg_name</userinput></screen>
</example>
<example><title>显示软件包归档中某个软件包的内容</title>
<para>显示软件包归档中某个软件包的内容。该软件包当前未安装。</para>
<screen>$ <userinput>pkg contents -g /my/archive.p5p pkg_name</userinput></screen>
</example>
<example><title>删除发布者的所有源和镜像</title>
<para>删除某个发布者的所有源和镜像，并添加新的源。</para>
<screen>$ <userinput>pkg set-publisher -G '*' -M '*' -g http://example.com:10000 &bsol;</userinput>
<userinput>example.com</userinput></screen>
</example>
<example><title>冻结和解除冻结映像</title>
<para>在这些示例中，<literal>/tmp/test_image</literal> 是要冻结和解除冻结的映像。</para>
<para>因为未指定发布者，所以以下命令作用于 <literal>/tmp/test_image</literal> 映像中启用的所有发布者，进而完全冻结 <literal>/tmp/test_image</literal> 映像。</para>
<screen>$ <userinput>pkg -R /tmp/test_image dehydrate</userinput></screen>
<para>因为未指定发布者，所以以下命令作用于 <literal>/tmp/test_image</literal> 映像中配置的所有发布者，以完全恢复 <literal>/tmp/test_image</literal> 映像。</para>
<screen>$ <userinput>pkg -R /tmp/test_image rehydrate</userinput></screen>
</example>
<example><title>冻结和解除冻结指定发布者的映像</title>
<para>在这些示例中，<literal>/tmp/test_image</literal> 是要冻结和解除冻结的映像，在 <literal>/tmp/test_image</literal> 映像中启用了 <literal>test1</literal> 和 <literal>test2</literal> 发布者且其源提供了必要的内容。</para>
<para>以下命令仅作用于 <literal>test1</literal> 发布者提供的文件和硬链接。</para>
<screen>$ <userinput>pkg -R /tmp/test_image dehydrate -p test1</userinput></screen>
<para>以下命令仅解除冻结 <literal>test1</literal> 发布者提供的文件和硬链接。</para>
<screen>$ <userinput>pkg -R /tmp/test_image rehydrate -p test1</userinput></screen>
</example>
<example><title>验证映像中的单个路径</title>
<para>验证路径 <literal>/tmp/test_image/usr/bin/ls</literal> 处的单个文件并显示详细结果。</para>
<screen>$ <userinput>pkg -R /tmp/test_image verify -v -p /usr/bin/ls</userinput></screen>
</example>
</refsect1>
<refsect1 role="environment-variables"><title></title>
<variablelist termlength="wholeline">
<varlistentry><term><envar>PKG_IMAGE</envar></term>
<listitem><para>用于软件包操作的映像所在的目录。如果指定了 <option>R</option>，则会忽略此属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><envar>PKG_CLIENT_CONNECT_TIMEOUT</envar></term>
<listitem><para>传输操作期间尝试建立连接时等待的秒数（针对每次尝试），达到此秒数后，客户端会异常中止操作。值 0 表示无限期等待。</para>
<para>缺省值：60</para>
</listitem>
</varlistentry>
<varlistentry><term><envar>PKG_CLIENT_LOWSPEED_TIMEOUT</envar></term>
<listitem><para>传输操作期间低于 <literal>lowspeed</literal> 限制（1024 字节/秒）的秒数，达到此秒数后，客户机会异常中止操作。值 0 表示不中止运行。</para>
<para>缺省值：30</para>
</listitem>
</varlistentry>
<varlistentry><term><envar>PKG_CLIENT_MAX_CONSECUTIVE_ERROR</envar></term>
<listitem><para>客户端异常中止操作之前发生瞬态传输错误的最大次数。值 0 表示不中止运行。</para>
<para>缺省值：4</para>
</listitem>
</varlistentry>
<varlistentry><term><envar>PKG_CLIENT_MAX_REDIRECT</envar></term>
<listitem><para>在传输操作期间，异常中止某个连接之前允许的最大 HTTP 或 HTTPS 重定向次数。值 0 表示不中止运行。</para>
<para>缺省值：5</para>
</listitem>
</varlistentry>
<varlistentry><term><envar>PKG_CONCURRENCY</envar></term>
<listitem><para>要并行更新的子映像数。如果指定了 <option>C</option> 选项，则会忽略此属性。</para>
<para>在递归检查子映像（通常为安装的 <literal>solaris</literal> 标记非全局区域）时，最多可以并行更新 <envar>$PKG_CONCURRENCY</envar> 个子映像。如果 <envar>$PKG_CONCURRENCY</envar> 为 0 或负数，则并行更新所有子映像。</para>
<para>缺省值：1</para>
</listitem>
</varlistentry>
<varlistentry><term><envar>PKG_CLIENT_MAX_TIMEOUT</envar></term>
<listitem><para>客户端异常中止操作之前每台主机上的最大传输尝试次数。值 0 表示不中止运行。</para>
<para>缺省值：4</para>
</listitem>
</varlistentry>
<varlistentry><term><envar>http_proxy</envar>、<envar>https_proxy</envar></term>
<listitem><para>HTTP 或 HTTPS 代理服务器。</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 role="exit-status"><title></title>
<para>将返回以下退出值：</para>
<variablelist>
<varlistentry><term><returnvalue>0</returnvalue></term>
<listitem><para>命令成功。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>1</returnvalue></term>
<listitem><para>出现错误。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>2</returnvalue></term>
<listitem><para>指定的命令行选项无效。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>3</returnvalue></term>
<listitem><para>请求了多项操作，但只有一部分操作成功。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>4</returnvalue></term>
<listitem><para>未进行更改－没有要执行的操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>5</returnvalue></term>
<listitem><para>无法对实时映像执行请求的操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>6</returnvalue></term>
<listitem><para>无法完成请求的操作，因为尚未接受所安装或更新的软件包的许可证。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>7</returnvalue></term>
<listitem><para>该映像当前已被另一个进程使用，无法修改。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>8</returnvalue></term>
<listitem><para>一个或多个 SMF 执行器超时。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>99</returnvalue></term>
<listitem><para>发生了意外的异常。</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 role="files"><title></title>
<para>可将 <literal>pkg</literal>(7) 映像放置在较大文件系统中的任意位置。在以下文件说明中，标记 <envar>$IMAGE_ROOT</envar> 用于区分相对路径。对于典型的系统安装，<envar>$IMAGE_ROOT</envar> 等效于 <literal>/</literal>。</para>
<variablelist termlength="wholeline">
<varlistentry><term><filename>$IMAGE_ROOT/var/pkg</filename></term>
<listitem><para>完整或部分映像的元数据目录。</para>
</listitem>
</varlistentry>
<varlistentry><term><filename>$IMAGE_ROOT/.org.opensolaris,pkg</filename></term>
<listitem><para>用户映像的元数据目录。</para>
</listitem>
</varlistentry>
</variablelist>
<para>在特定映像的元数据中，某些文件和目录可能包含修复和恢复期间有用的信息。标记 <envar>$IMAGE_META</envar> 引用元数据所在的顶层目录。<envar>$IMAGE_META</envar> 通常是上述两个路径之一。</para>
<variablelist termlength="wholeline">
<varlistentry><term><filename>$IMAGE_META/lost+found</filename></term>
<listitem><para>在软件包操作期间移动的有冲突目录和文件的位置。某个已删除目录的未打包内容的位置。</para>
</listitem>
</varlistentry>
<varlistentry><term><filename>$IMAGE_META/publisher</filename></term>
<listitem><para>为每个发布者包含一个目录。每个目录存储特定于发布者的元数据。</para>
</listitem>
</varlistentry>
</variablelist>
<para><envar>$IMAGE_META</envar> 目录分层结构中的其他路径是专用的，可能会进行更改。</para>
</refsect1>
<refsect1 role="attributes"><title></title>
<para>有关下列属性的说明，请参见 <literal>attributes</literal>(7)：</para>
<informaltable frame="all" orient="port">
<textobject>
<simpara>Table shows applicable attribute types and related values.</simpara>
</textobject>
<tgroup cols="2" colsep="1" rowsep="1"><colspec colname="col1" colwidth="198*" align="left" /><colspec colname="col2" colwidth="198*" align="left" /><thead>
<row>
<entry align="center">
<para>属性类型</para>
</entry>
<entry align="center">
<para>属性值</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left">
<para>可用性</para>
</entry>
<entry align="left">
<para><literal>package/pkg</literal></para>
</entry>
</row>
<row>
<entry align="left">
<para>接口稳定性</para>
</entry>
<entry align="left">
<para>Uncommitted（未确定）</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable></refsect1>
<refsect1 role="see-also"><title></title>
<para><olink targetdoc="refman" targetptr="pkgsend-1"><citerefentry><refentrytitle>pkgsend</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink>、<olink targetdoc="refman" targetptr="beadm-8"><citerefentry><refentrytitle>beadm</refentrytitle><manvolnum>8</manvolnum></citerefentry></olink>、<olink targetdoc="refman" targetptr="pkg.depotd-8"><citerefentry><refentrytitle>pkg.depotd</refentrytitle><manvolnum>8</manvolnum></citerefentry></olink>、<olink targetdoc="refman" targetptr="pkg.sysrepo-8"><citerefentry><refentrytitle>pkg.sysrepo</refentrytitle><manvolnum>8</manvolnum></citerefentry></olink>、<literal>glob</literal>(3C)、<olink targetdoc="refman" targetptr="pkg-7"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>7</manvolnum></citerefentry></olink></para>
<para><olink targetdoc="AUOSS">《<citetitle remap="book">在 Oracle Solaris 11.2 中添加和更新软件</citetitle>》</olink></para>
<para><literal>https://github.com/oracle/solaris-ips</literal></para>
</refsect1>
</refentry>
